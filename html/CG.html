<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>CG</title><link rel="stylesheet" href="Agda.css"></head><body><pre><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="Lattice.html" class="Module">Lattice</a>

<a id="22" class="Keyword">module</a> <a id="29" href="CG.html" class="Module">CG</a> <a id="32" class="Symbol">{{</a><a id="34" href="CG.html#34" class="Bound">𝑳</a> <a id="36" class="Symbol">:</a> <a id="38" href="Lattice.html#Lattice" class="Function">Lattice</a><a id="45" class="Symbol">}}</a> <a id="48" class="Keyword">where</a>

<a id="55" class="Comment">-- Types and context</a>
<a id="76" class="Keyword">open</a> <a id="81" class="Keyword">import</a> <a id="88" href="CG.Types.html" class="Module">CG.Types</a> <a id="97" class="Keyword">public</a>

<a id="105" class="Comment">-- Well-typed Syntax</a>
<a id="126" class="Keyword">open</a> <a id="131" class="Keyword">import</a> <a id="138" href="CG.Syntax.html" class="Module">CG.Syntax</a> <a id="148" class="Keyword">public</a>

<a id="156" class="Comment">-- Big-step semantics</a>
<a id="178" class="Keyword">open</a> <a id="183" class="Keyword">import</a> <a id="190" href="CG.Semantics.html" class="Module">CG.Semantics</a> <a id="203" class="Keyword">public</a>

<a id="211" class="Comment">-- References are valid</a>
<a id="235" class="Keyword">open</a> <a id="240" class="Keyword">import</a> <a id="247" href="CG.Valid.html" class="Module">CG.Valid</a> <a id="256" class="Keyword">public</a>

<a id="264" class="Comment">-- Bijections</a>
<a id="278" class="Keyword">open</a> <a id="283" class="Keyword">import</a> <a id="290" href="Generic.Bijection.html" class="Module">Generic.Bijection</a>

<a id="309" class="Comment">--------------------------------------------------------------------------------</a>
<a id="390" class="Comment">-- Top-level L-equivalence bindings that explicitly take the attacker</a>
<a id="460" class="Comment">-- security level.</a>

<a id="_≈ᴵ⟨_,_⟩_" href="CG.html#_%E2%89%88%E1%B4%B5%E2%9F%A8_%2C_%E2%9F%A9_" class="Function Operator">_≈ᴵ⟨_,_⟩_</a> <a id="490" class="Symbol">:</a> <a id="492" class="Symbol">∀</a> <a id="494" class="Symbol">{</a><a id="495" href="CG.html#495" class="Bound">τ</a> <a id="497" href="CG.html#497" class="Bound">Γ</a><a id="498" class="Symbol">}</a> <a id="500" class="Symbol">→</a> <a id="502" href="CG.Syntax.html#EConf" class="Function">EConf</a> <a id="508" href="CG.html#497" class="Bound">Γ</a> <a id="510" href="CG.html#495" class="Bound">τ</a> <a id="512" class="Symbol">→</a> <a id="514" href="Lattice.Base.html#Label" class="Field">Label</a> <a id="520" class="Symbol">→</a> <a id="522" href="Generic.Bijection.html#Bij" class="Function">Bij</a> <a id="526" class="Symbol">→</a> <a id="528" href="CG.Syntax.html#EConf" class="Function">EConf</a> <a id="534" href="CG.html#497" class="Bound">Γ</a> <a id="536" href="CG.html#495" class="Bound">τ</a> <a id="538" class="Symbol">→</a> <a id="540" class="PrimitiveType">Set</a>
<a id="544" href="CG.html#544" class="Bound">c₁</a> <a id="547" href="CG.html#_%E2%89%88%E1%B4%B5%E2%9F%A8_%2C_%E2%9F%A9_" class="Function Operator">≈ᴵ⟨</a> <a id="551" href="CG.html#551" class="Bound">A</a> <a id="553" href="CG.html#_%E2%89%88%E1%B4%B5%E2%9F%A8_%2C_%E2%9F%A9_" class="Function Operator">,</a> <a id="555" href="CG.html#555" class="Bound">β</a> <a id="557" href="CG.html#_%E2%89%88%E1%B4%B5%E2%9F%A8_%2C_%E2%9F%A9_" class="Function Operator">⟩</a> <a id="559" href="CG.html#559" class="Bound">c₂</a> <a id="562" class="Symbol">=</a> <a id="564" href="CG.html#544" class="Bound">c₁</a> <a id="567" href="CG.LowEq.html#4599" class="Function Operator">≈⟨</a> <a id="570" href="CG.html#555" class="Bound">β</a> <a id="572" href="CG.LowEq.html#4599" class="Function Operator">⟩ᴵ</a> <a id="575" href="CG.html#559" class="Bound">c₂</a>
  <a id="580" class="Keyword">where</a> <a id="586" class="Keyword">open</a> <a id="591" class="Keyword">import</a> <a id="598" href="CG.LowEq.html" class="Module">CG.LowEq</a> <a id="607" href="CG.html#551" class="Bound">A</a>

<a id="_≈ⱽ⟨_,_⟩_" href="CG.html#_%E2%89%88%E2%B1%BD%E2%9F%A8_%2C_%E2%9F%A9_" class="Function Operator">_≈ⱽ⟨_,_⟩_</a> <a id="620" class="Symbol">:</a> <a id="622" class="Symbol">∀</a> <a id="624" class="Symbol">{</a><a id="625" href="CG.html#625" class="Bound">τ</a><a id="626" class="Symbol">}</a> <a id="628" class="Symbol">→</a> <a id="630" href="CG.Syntax.html#Value" class="Datatype">Value</a> <a id="636" href="CG.html#625" class="Bound">τ</a> <a id="638" class="Symbol">→</a> <a id="640" href="Lattice.Base.html#Label" class="Field">Label</a> <a id="646" class="Symbol">→</a> <a id="648" href="Generic.Bijection.html#Bij" class="Function">Bij</a> <a id="652" class="Symbol">→</a> <a id="654" href="CG.Syntax.html#Value" class="Datatype">Value</a> <a id="660" href="CG.html#625" class="Bound">τ</a> <a id="662" class="Symbol">→</a> <a id="664" class="PrimitiveType">Set</a>
<a id="668" href="CG.html#668" class="Bound">v₁</a> <a id="671" href="CG.html#_%E2%89%88%E2%B1%BD%E2%9F%A8_%2C_%E2%9F%A9_" class="Function Operator">≈ⱽ⟨</a> <a id="675" href="CG.html#675" class="Bound">A</a> <a id="677" href="CG.html#_%E2%89%88%E2%B1%BD%E2%9F%A8_%2C_%E2%9F%A9_" class="Function Operator">,</a> <a id="679" href="CG.html#679" class="Bound">β</a> <a id="681" href="CG.html#_%E2%89%88%E2%B1%BD%E2%9F%A8_%2C_%E2%9F%A9_" class="Function Operator">⟩</a> <a id="683" href="CG.html#683" class="Bound">v₂</a> <a id="686" class="Symbol">=</a> <a id="688" href="CG.html#668" class="Bound">v₁</a> <a id="691" href="CG.LowEq.html#782" class="Datatype Operator">≈⟨</a> <a id="694" href="CG.html#679" class="Bound">β</a> <a id="696" href="CG.LowEq.html#782" class="Datatype Operator">⟩ⱽ</a> <a id="699" href="CG.html#683" class="Bound">v₂</a>
  <a id="704" class="Keyword">where</a> <a id="710" class="Keyword">open</a> <a id="715" class="Keyword">import</a> <a id="722" href="CG.LowEq.html" class="Module">CG.LowEq</a> <a id="731" href="CG.html#675" class="Bound">A</a>

<a id="_≈ᴱ⟨_,_⟩_" href="CG.html#_%E2%89%88%E1%B4%B1%E2%9F%A8_%2C_%E2%9F%A9_" class="Function Operator">_≈ᴱ⟨_,_⟩_</a> <a id="744" class="Symbol">:</a> <a id="746" class="Symbol">∀</a> <a id="748" class="Symbol">{</a><a id="749" href="CG.html#749" class="Bound">Γ</a><a id="750" class="Symbol">}</a> <a id="752" class="Symbol">→</a> <a id="754" href="CG.Syntax.html#Env" class="Datatype">Env</a> <a id="758" href="CG.html#749" class="Bound">Γ</a> <a id="760" class="Symbol">→</a> <a id="762" href="Lattice.Base.html#Label" class="Field">Label</a> <a id="768" class="Symbol">→</a> <a id="770" href="Generic.Bijection.html#Bij" class="Function">Bij</a> <a id="774" class="Symbol">→</a> <a id="776" href="CG.Syntax.html#Env" class="Datatype">Env</a> <a id="780" href="CG.html#749" class="Bound">Γ</a> <a id="782" class="Symbol">→</a> <a id="784" class="PrimitiveType">Set</a>
<a id="788" href="CG.html#788" class="Bound">r₁</a> <a id="791" href="CG.html#_%E2%89%88%E1%B4%B1%E2%9F%A8_%2C_%E2%9F%A9_" class="Function Operator">≈ᴱ⟨</a> <a id="795" href="CG.html#795" class="Bound">A</a> <a id="797" href="CG.html#_%E2%89%88%E1%B4%B1%E2%9F%A8_%2C_%E2%9F%A9_" class="Function Operator">,</a> <a id="799" href="CG.html#799" class="Bound">β</a> <a id="801" href="CG.html#_%E2%89%88%E1%B4%B1%E2%9F%A8_%2C_%E2%9F%A9_" class="Function Operator">⟩</a> <a id="803" href="CG.html#803" class="Bound">r₂</a> <a id="806" class="Symbol">=</a> <a id="808" href="CG.html#788" class="Bound">r₁</a> <a id="811" href="CG.LowEq.html#2257" class="Datatype Operator">≈⟨</a> <a id="814" href="CG.html#799" class="Bound">β</a> <a id="816" href="CG.LowEq.html#2257" class="Datatype Operator">⟩ᴱ</a> <a id="819" href="CG.html#803" class="Bound">r₂</a>
  <a id="824" class="Keyword">where</a> <a id="830" class="Keyword">open</a> <a id="835" class="Keyword">import</a> <a id="842" href="CG.LowEq.html" class="Module">CG.LowEq</a> <a id="851" href="CG.html#795" class="Bound">A</a>

<a id="_≈ᶜ⟨_,_⟩_" href="CG.html#_%E2%89%88%E1%B6%9C%E2%9F%A8_%2C_%E2%9F%A9_" class="Function Operator">_≈ᶜ⟨_,_⟩_</a> <a id="864" class="Symbol">:</a> <a id="866" class="Symbol">∀</a> <a id="868" class="Symbol">{</a><a id="869" href="CG.html#869" class="Bound">τ</a><a id="870" class="Symbol">}</a> <a id="872" class="Symbol">→</a> <a id="874" href="CG.Syntax.html#FConf" class="Function">FConf</a> <a id="880" href="CG.html#869" class="Bound">τ</a> <a id="882" class="Symbol">→</a> <a id="884" href="Lattice.Base.html#Label" class="Field">Label</a> <a id="890" class="Symbol">→</a> <a id="892" href="Generic.Bijection.html#Bij" class="Function">Bij</a> <a id="896" class="Symbol">→</a> <a id="898" href="CG.Syntax.html#FConf" class="Function">FConf</a> <a id="904" href="CG.html#869" class="Bound">τ</a> <a id="906" class="Symbol">→</a> <a id="908" class="PrimitiveType">Set</a>
<a id="912" href="CG.html#912" class="Bound">c₁</a> <a id="915" href="CG.html#_%E2%89%88%E1%B6%9C%E2%9F%A8_%2C_%E2%9F%A9_" class="Function Operator">≈ᶜ⟨</a> <a id="919" href="CG.html#919" class="Bound">A</a> <a id="921" href="CG.html#_%E2%89%88%E1%B6%9C%E2%9F%A8_%2C_%E2%9F%A9_" class="Function Operator">,</a> <a id="923" href="CG.html#923" class="Bound">β</a> <a id="925" href="CG.html#_%E2%89%88%E1%B6%9C%E2%9F%A8_%2C_%E2%9F%A9_" class="Function Operator">⟩</a> <a id="927" href="CG.html#927" class="Bound">c₂</a> <a id="930" class="Symbol">=</a> <a id="932" href="CG.html#912" class="Bound">c₁</a> <a id="935" href="CG.LowEq.html#4830" class="Datatype Operator">≈⟨</a> <a id="938" href="CG.html#923" class="Bound">β</a> <a id="940" href="CG.LowEq.html#4830" class="Datatype Operator">⟩ᶜ</a> <a id="943" href="CG.html#927" class="Bound">c₂</a>
  <a id="948" class="Keyword">where</a> <a id="954" class="Keyword">open</a> <a id="959" class="Keyword">import</a> <a id="966" href="CG.LowEq.html" class="Module">CG.LowEq</a> <a id="975" href="CG.html#919" class="Bound">A</a>

<a id="_≈ᴹ⟨_,_⟩_" href="CG.html#_%E2%89%88%E1%B4%B9%E2%9F%A8_%2C_%E2%9F%A9_" class="Function Operator">_≈ᴹ⟨_,_⟩_</a> <a id="988" class="Symbol">:</a> <a id="990" class="Symbol">∀</a> <a id="992" class="Symbol">{</a><a id="993" href="CG.html#993" class="Bound">ℓ</a><a id="994" class="Symbol">}</a> <a id="996" class="Symbol">→</a> <a id="998" href="Generic.Memory.Base.html#Memory" class="Function">Memory</a> <a id="1005" href="CG.html#993" class="Bound">ℓ</a> <a id="1007" class="Symbol">→</a> <a id="1009" href="Lattice.Base.html#Label" class="Field">Label</a> <a id="1015" class="Symbol">→</a> <a id="1017" href="Generic.Bijection.html#Bij" class="Function">Bij</a> <a id="1021" class="Symbol">→</a> <a id="1023" href="Generic.Memory.Base.html#Memory" class="Function">Memory</a> <a id="1030" href="CG.html#993" class="Bound">ℓ</a> <a id="1032" class="Symbol">→</a> <a id="1034" class="PrimitiveType">Set</a>
<a id="1038" href="CG.html#1038" class="Bound">M₁</a> <a id="1041" href="CG.html#_%E2%89%88%E1%B4%B9%E2%9F%A8_%2C_%E2%9F%A9_" class="Function Operator">≈ᴹ⟨</a> <a id="1045" href="CG.html#1045" class="Bound">A</a> <a id="1047" href="CG.html#_%E2%89%88%E1%B4%B9%E2%9F%A8_%2C_%E2%9F%A9_" class="Function Operator">,</a> <a id="1049" href="CG.html#1049" class="Bound">β</a> <a id="1051" href="CG.html#_%E2%89%88%E1%B4%B9%E2%9F%A8_%2C_%E2%9F%A9_" class="Function Operator">⟩</a> <a id="1053" href="CG.html#1053" class="Bound">M₂</a> <a id="1056" class="Symbol">=</a> <a id="1058" href="CG.html#1038" class="Bound">M₁</a> <a id="1061" href="Generic.Memory.LowEq.html#_%E2%89%88%E2%9F%A8_%2C_%E2%9F%A9%E1%B4%B9_" class="Function Operator">≈⟨</a> <a id="1064" href="CG.html#1049" class="Bound">β</a> <a id="1066" href="Generic.Memory.LowEq.html#_%E2%89%88%E2%9F%A8_%2C_%E2%9F%A9%E1%B4%B9_" class="Function Operator">,</a> <a id="1068" class="Symbol">_</a> <a id="1070" href="Relation.Binary.html#_%E2%8A%91%3F_" class="Function Operator">⊑?</a> <a id="1073" href="CG.html#1045" class="Bound">A</a> <a id="1075" href="Generic.Memory.LowEq.html#_%E2%89%88%E2%9F%A8_%2C_%E2%9F%A9%E1%B4%B9_" class="Function Operator">⟩ᴹ</a> <a id="1078" href="CG.html#1053" class="Bound">M₂</a>
  <a id="1083" class="Keyword">where</a> <a id="1089" class="Keyword">open</a> <a id="1094" class="Keyword">import</a> <a id="1101" href="CG.LowEq.html" class="Module">CG.LowEq</a> <a id="1110" href="CG.html#1045" class="Bound">A</a>

<a id="_≈ˢ⟨_,_⟩_" href="CG.html#_%E2%89%88%CB%A2%E2%9F%A8_%2C_%E2%9F%A9_" class="Function Operator">_≈ˢ⟨_,_⟩_</a> <a id="1123" class="Symbol">:</a> <a id="1125" href="Generic.Store.Base.html#Store" class="Function">Store</a> <a id="1131" class="Symbol">→</a> <a id="1133" href="Lattice.Base.html#Label" class="Field">Label</a> <a id="1139" class="Symbol">→</a> <a id="1141" href="Generic.Bijection.html#Bij" class="Function">Bij</a> <a id="1145" class="Symbol">→</a> <a id="1147" href="Generic.Store.Base.html#Store" class="Function">Store</a> <a id="1153" class="Symbol">→</a> <a id="1155" class="PrimitiveType">Set</a>
<a id="1159" href="CG.html#1159" class="Bound">Σ₁</a> <a id="1162" href="CG.html#_%E2%89%88%CB%A2%E2%9F%A8_%2C_%E2%9F%A9_" class="Function Operator">≈ˢ⟨</a> <a id="1166" href="CG.html#1166" class="Bound">A</a> <a id="1168" href="CG.html#_%E2%89%88%CB%A2%E2%9F%A8_%2C_%E2%9F%A9_" class="Function Operator">,</a> <a id="1170" href="CG.html#1170" class="Bound">β</a> <a id="1172" href="CG.html#_%E2%89%88%CB%A2%E2%9F%A8_%2C_%E2%9F%A9_" class="Function Operator">⟩</a> <a id="1174" href="CG.html#1174" class="Bound">Σ₂</a> <a id="1177" class="Symbol">=</a> <a id="1179" href="CG.html#1159" class="Bound">Σ₁</a> <a id="1182" href="Generic.Store.LowEq.html#_%E2%89%88%E2%9F%A8_%E2%9F%A9%CB%A2_" class="Function Operator">≈⟨</a> <a id="1185" href="CG.html#1170" class="Bound">β</a> <a id="1187" href="Generic.Store.LowEq.html#_%E2%89%88%E2%9F%A8_%E2%9F%A9%CB%A2_" class="Function Operator">⟩ˢ</a> <a id="1190" href="CG.html#1174" class="Bound">Σ₂</a>
  <a id="1195" class="Keyword">where</a> <a id="1201" class="Keyword">open</a> <a id="1206" class="Keyword">import</a> <a id="1213" href="CG.LowEq.html" class="Module">CG.LowEq</a> <a id="1222" href="CG.html#1166" class="Bound">A</a>

<a id="1225" class="Comment">--------------------------------------------------------------------------------</a>
<a id="1306" class="Comment">-- Calculus record</a>

<a id="1326" class="Keyword">open</a> <a id="1331" class="Keyword">import</a> <a id="1338" href="Generic.Calculus.html" class="Module">Generic.Calculus</a>
<a id="1355" class="Keyword">open</a> <a id="1360" class="Keyword">import</a> <a id="1367" href="CG.Valid.html" class="Module">CG.Valid</a>

<a id="λ^CG" href="CG.html#%CE%BB%5ECG" class="Function">λ^CG</a> <a id="1382" class="Symbol">:</a> <a id="1384" href="Generic.Calculus.html#Calculus" class="Record">Calculus</a>
<a id="1393" href="CG.html#%CE%BB%5ECG" class="Function">λ^CG</a> <a id="1398" class="Symbol">=</a> <a id="1400" class="Keyword">record</a>
         <a id="1416" class="Symbol">{</a> <a id="1418" class="Field">Ty</a> <a id="1421" class="Symbol">=</a> <a id="1423" href="CG.Types.html#Ty" class="Datatype">Ty</a>
         <a id="1435" class="Symbol">;</a> <a id="1437" class="Field">Input</a> <a id="1443" class="Symbol">=</a> <a id="1445" href="CG.Syntax.html#Env" class="Datatype">Env</a>
         <a id="1458" class="Symbol">;</a> <a id="1460" class="Field">IConf</a> <a id="1466" class="Symbol">=</a> <a id="1468" href="CG.Syntax.html#EConf" class="Function">EConf</a>
         <a id="1483" class="Symbol">;</a> <a id="1485" class="Field">FConf</a> <a id="1491" class="Symbol">=</a> <a id="1493" href="CG.Syntax.html#FConf" class="Function">FConf</a>
         <a id="1508" class="Symbol">;</a> <a id="1510" class="Field">Valid-Inputs</a> <a id="1523" class="Symbol">=</a> <a id="1525" href="CG.Valid.html#Valid-Inputs" class="Function">Valid-Inputs</a>
         <a id="1547" class="Symbol">;</a> <a id="1549" class="Field Operator">I⟨_⟩</a> <a id="1554" class="Symbol">=</a> <a id="1556" href="CG.Types.html#Ty.LIO" class="InductiveConstructor">LIO</a>
         <a id="1569" class="Symbol">;</a> <a id="1571" class="Field Operator">_⇓⟨_⟩_</a> <a id="1578" class="Symbol">=</a> <a id="1580" href="CG.Semantics.html#_%E2%87%93%E1%B6%A0%E2%9F%A8_%E2%9F%A9_" class="Function Operator">_⇓ᶠ⟨_⟩_</a>
         <a id="1597" class="Symbol">;</a> <a id="1599" class="Field Operator">_≈ᴱ⟨_,_⟩_</a> <a id="1609" class="Symbol">=</a> <a id="1611" href="CG.html#_%E2%89%88%E1%B4%B1%E2%9F%A8_%2C_%E2%9F%A9_" class="Function Operator">_≈ᴱ⟨_,_⟩_</a>
         <a id="1630" class="Symbol">;</a> <a id="1632" class="Field Operator">_≈ᴵ⟨_,_⟩_</a> <a id="1642" class="Symbol">=</a> <a id="1644" href="CG.html#_%E2%89%88%E1%B4%B5%E2%9F%A8_%2C_%E2%9F%A9_" class="Function Operator">_≈ᴵ⟨_,_⟩_</a>
         <a id="1663" class="Symbol">;</a> <a id="1665" class="Field Operator">_≈ᶠ⟨_,_⟩_</a> <a id="1675" class="Symbol">=</a> <a id="1677" href="CG.html#_%E2%89%88%E1%B6%9C%E2%9F%A8_%2C_%E2%9F%A9_" class="Function Operator">_≈ᶜ⟨_,_⟩_</a>
         <a id="1696" class="Symbol">}</a>

<a id="CG-TINI" href="CG.html#CG-TINI" class="Function">CG-TINI</a> <a id="1707" class="Symbol">:</a> <a id="1709" href="Generic.Calculus.html#TINI" class="Function">TINI</a> <a id="1714" href="CG.html#%CE%BB%5ECG" class="Function">λ^CG</a>
<a id="1719" href="CG.html#CG-TINI" class="Function">CG-TINI</a> <a id="1727" class="Symbol">{</a><a id="1728" class="Argument">A</a> <a id="1730" class="Symbol">=</a> <a id="1732" href="CG.html#1732" class="Bound">A</a><a id="1733" class="Symbol">}</a> <a id="1735" href="CG.html#1735" class="Bound">isV₁</a> <a id="1740" href="CG.html#1740" class="Bound">isV₂</a> <a id="1745" class="Symbol">=</a> <a id="1747" href="CG.Security.html#14083" class="Function">tiniᶠ</a> <a id="1753" class="Symbol">{{</a><a id="1755" href="CG.html#1735" class="Bound">isV₁</a><a id="1759" class="Symbol">}}</a> <a id="1762" class="Symbol">{{</a><a id="1764" href="CG.html#1740" class="Bound">isV₂</a><a id="1768" class="Symbol">}}</a>
  <a id="1773" class="Keyword">where</a> <a id="1779" class="Keyword">open</a> <a id="1784" class="Keyword">import</a> <a id="1791" href="CG.Security.html" class="Module">CG.Security</a> <a id="1803" href="CG.html#1732" class="Bound">A</a>
</pre></body></html>