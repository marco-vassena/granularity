<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Generic.Calculus</title><link rel="stylesheet" href="Agda.css"></head><body><pre><a id="1" class="Keyword">module</a> <a id="8" href="Generic.Calculus.html" class="Module">Generic.Calculus</a> <a id="25" class="Keyword">where</a>

<a id="32" class="Keyword">open</a> <a id="37" class="Keyword">import</a> <a id="44" href="Data.List.html" class="Module">Data.List</a>
<a id="54" class="Keyword">open</a> <a id="59" class="Keyword">import</a> <a id="66" href="Generic.Context.html" class="Module">Generic.Context</a> <a id="82" class="Keyword">using</a> <a id="88" class="Symbol">(</a><a id="89" href="Generic.Context.Base.html#Ctx" class="Function">Ctx</a><a id="92" class="Symbol">)</a>
<a id="94" class="Keyword">open</a> <a id="99" class="Keyword">import</a> <a id="106" href="Relation.Binary.html" class="Module">Relation.Binary</a>
<a id="122" class="Keyword">open</a> <a id="127" class="Keyword">import</a> <a id="134" href="Level.html" class="Module">Level</a>
<a id="140" class="Keyword">open</a> <a id="145" class="Keyword">import</a> <a id="152" href="Lattice.html" class="Module">Lattice</a>
<a id="160" class="Keyword">open</a> <a id="165" class="Keyword">import</a> <a id="172" href="Generic.Bijection.html" class="Module">Generic.Bijection</a>

<a id="191" class="Comment">-- TODO: why is this here?</a>
<a id="218" class="Comment">-- A simple flag to distinguish flow-insensitive (I) and</a>
<a id="275" class="Comment">-- flow-sensitive (S) references</a>
<a id="308" class="Keyword">data</a> <a id="Flow" href="Generic.Calculus.html#Flow" class="Datatype">Flow</a> <a id="318" class="Symbol">:</a> <a id="320" class="PrimitiveType">Set</a> <a id="324" class="Keyword">where</a>
  <a id="Flow.I" href="Generic.Calculus.html#Flow.I" class="InductiveConstructor">I</a> <a id="Flow.S" href="Generic.Calculus.html#Flow.S" class="InductiveConstructor">S</a> <a id="336" class="Symbol">:</a> <a id="338" href="Generic.Calculus.html#Flow" class="Datatype">Flow</a>

<a id="344" class="Comment">-- A generic record for security calculi with well-typed syntax and</a>
<a id="412" class="Comment">-- big-step semantics.</a>
<a id="435" class="Keyword">record</a> <a id="Calculus" href="Generic.Calculus.html#Calculus" class="Record">Calculus</a> <a id="451" class="Symbol">{{</a><a id="453" href="Generic.Calculus.html#453" class="Bound">𝑳</a> <a id="455" class="Symbol">:</a> <a id="457" href="Lattice.html#Lattice" class="Function">Lattice</a><a id="464" class="Symbol">}}</a> <a id="467" class="Symbol">:</a> <a id="469" class="PrimitiveType">Set₁</a> <a id="474" class="Keyword">where</a>
  <a id="482" class="Keyword">field</a> <a id="Calculus.Ty" href="Generic.Calculus.html#Calculus.Ty" class="Field">Ty</a> <a id="491" class="Symbol">:</a> <a id="493" class="PrimitiveType">Set</a>
        <a id="Calculus.Input" href="Generic.Calculus.html#Calculus.Input" class="Field">Input</a> <a id="511" class="Symbol">:</a> <a id="513" href="Generic.Context.Base.html#Ctx" class="Function">Ctx</a> <a id="517" href="Generic.Calculus.html#Calculus.Ty" class="Field">Ty</a> <a id="520" class="Symbol">→</a> <a id="522" class="PrimitiveType">Set</a>
        <a id="Calculus.IConf" href="Generic.Calculus.html#Calculus.IConf" class="Field">IConf</a> <a id="540" class="Symbol">:</a> <a id="542" href="Generic.Context.Base.html#Ctx" class="Function">Ctx</a> <a id="546" href="Generic.Calculus.html#Calculus.Ty" class="Field">Ty</a> <a id="549" class="Symbol">→</a> <a id="551" href="Generic.Calculus.html#Calculus.Ty" class="Field">Ty</a> <a id="554" class="Symbol">→</a> <a id="556" class="PrimitiveType">Set</a>
        <a id="Calculus.FConf" href="Generic.Calculus.html#Calculus.FConf" class="Field">FConf</a> <a id="574" class="Symbol">:</a> <a id="576" href="Generic.Calculus.html#Calculus.Ty" class="Field">Ty</a> <a id="579" class="Symbol">→</a> <a id="581" class="PrimitiveType">Set</a>
        <a id="Calculus.I⟨_⟩" href="Generic.Calculus.html#Calculus.I%E2%9F%A8_%E2%9F%A9" class="Field Operator">I⟨_⟩</a> <a id="598" class="Symbol">:</a> <a id="600" href="Generic.Calculus.html#Calculus.Ty" class="Field">Ty</a> <a id="603" class="Symbol">→</a> <a id="605" href="Generic.Calculus.html#Calculus.Ty" class="Field">Ty</a> <a id="608" class="Comment">-- Generic type preservation in the semantics</a>
        <a id="Calculus._⇓⟨_⟩_" href="Generic.Calculus.html#Calculus._%E2%87%93%E2%9F%A8_%E2%9F%A9_" class="Field Operator">_⇓⟨_⟩_</a> <a id="669" class="Symbol">:</a> <a id="671" class="Symbol">∀</a> <a id="673" class="Symbol">{</a><a id="674" href="Generic.Calculus.html#674" class="Bound">Γ</a> <a id="676" href="Generic.Calculus.html#676" class="Bound">τ</a><a id="677" class="Symbol">}</a> <a id="679" class="Symbol">→</a> <a id="681" href="Generic.Calculus.html#Calculus.IConf" class="Field">IConf</a> <a id="687" href="Generic.Calculus.html#674" class="Bound">Γ</a> <a id="689" href="Generic.Calculus.html#Calculus.I%E2%9F%A8_%E2%9F%A9" class="Field Operator">I⟨</a> <a id="692" href="Generic.Calculus.html#676" class="Bound">τ</a> <a id="694" href="Generic.Calculus.html#Calculus.I%E2%9F%A8_%E2%9F%A9" class="Field Operator">⟩</a> <a id="696" class="Symbol">→</a> <a id="698" href="Generic.Calculus.html#Calculus.Input" class="Field">Input</a> <a id="704" href="Generic.Calculus.html#674" class="Bound">Γ</a> <a id="706" class="Symbol">→</a> <a id="708" href="Generic.Calculus.html#Calculus.FConf" class="Field">FConf</a> <a id="714" href="Generic.Calculus.html#676" class="Bound">τ</a> <a id="716" class="Symbol">→</a> <a id="718" class="PrimitiveType">Set</a>
        <a id="Calculus.Valid-Inputs" href="Generic.Calculus.html#Calculus.Valid-Inputs" class="Field">Valid-Inputs</a> <a id="743" class="Symbol">:</a> <a id="745" class="Symbol">∀</a> <a id="747" class="Symbol">{</a><a id="748" href="Generic.Calculus.html#748" class="Bound">Γ</a><a id="749" class="Symbol">}</a> <a id="751" class="Symbol">{</a><a id="752" href="Generic.Calculus.html#752" class="Bound">τ</a><a id="753" class="Symbol">}</a> <a id="755" class="Symbol">→</a> <a id="757" href="Generic.Calculus.html#Calculus.IConf" class="Field">IConf</a> <a id="763" href="Generic.Calculus.html#748" class="Bound">Γ</a> <a id="765" href="Generic.Calculus.html#752" class="Bound">τ</a> <a id="767" class="Symbol">→</a> <a id="769" href="Generic.Calculus.html#Calculus.Input" class="Field">Input</a> <a id="775" href="Generic.Calculus.html#748" class="Bound">Γ</a> <a id="777" class="Symbol">→</a>  <a id="780" class="PrimitiveType">Set</a>

        <a id="793" class="Comment">-- Low-equivalence</a>
        <a id="Calculus._≈ᴱ⟨_,_⟩_" href="Generic.Calculus.html#Calculus._%E2%89%88%E1%B4%B1%E2%9F%A8_%2C_%E2%9F%A9_" class="Field Operator">_≈ᴱ⟨_,_⟩_</a> <a id="830" class="Symbol">:</a> <a id="832" class="Symbol">∀</a> <a id="834" class="Symbol">{</a><a id="835" href="Generic.Calculus.html#835" class="Bound">Γ</a><a id="836" class="Symbol">}</a> <a id="838" class="Symbol">→</a> <a id="840" href="Generic.Calculus.html#Calculus.Input" class="Field">Input</a> <a id="846" href="Generic.Calculus.html#835" class="Bound">Γ</a> <a id="848" class="Symbol">→</a> <a id="850" href="Lattice.Base.html#Label" class="Field">Label</a> <a id="856" class="Symbol">→</a> <a id="858" href="Generic.Bijection.html#Bij" class="Function">Bij</a> <a id="862" class="Symbol">→</a> <a id="864" href="Generic.Calculus.html#Calculus.Input" class="Field">Input</a> <a id="870" href="Generic.Calculus.html#835" class="Bound">Γ</a> <a id="872" class="Symbol">→</a> <a id="874" class="PrimitiveType">Set</a>
        <a id="Calculus._≈ᴵ⟨_,_⟩_" href="Generic.Calculus.html#Calculus._%E2%89%88%E1%B4%B5%E2%9F%A8_%2C_%E2%9F%A9_" class="Field Operator">_≈ᴵ⟨_,_⟩_</a> <a id="896" class="Symbol">:</a> <a id="898" class="Symbol">∀</a> <a id="900" class="Symbol">{</a><a id="901" href="Generic.Calculus.html#901" class="Bound">Γ</a> <a id="903" href="Generic.Calculus.html#903" class="Bound">τ</a><a id="904" class="Symbol">}</a> <a id="906" class="Symbol">→</a> <a id="908" href="Generic.Calculus.html#Calculus.IConf" class="Field">IConf</a> <a id="914" href="Generic.Calculus.html#901" class="Bound">Γ</a> <a id="916" href="Generic.Calculus.html#903" class="Bound">τ</a> <a id="918" class="Symbol">→</a> <a id="920" href="Lattice.Base.html#Label" class="Field">Label</a> <a id="926" class="Symbol">→</a> <a id="928" href="Generic.Bijection.html#Bij" class="Function">Bij</a> <a id="932" class="Symbol">→</a> <a id="934" href="Generic.Calculus.html#Calculus.IConf" class="Field">IConf</a> <a id="940" href="Generic.Calculus.html#901" class="Bound">Γ</a> <a id="942" href="Generic.Calculus.html#903" class="Bound">τ</a> <a id="944" class="Symbol">→</a> <a id="946" class="PrimitiveType">Set</a>
        <a id="Calculus._≈ᶠ⟨_,_⟩_" href="Generic.Calculus.html#Calculus._%E2%89%88%E1%B6%A0%E2%9F%A8_%2C_%E2%9F%A9_" class="Field Operator">_≈ᶠ⟨_,_⟩_</a> <a id="968" class="Symbol">:</a> <a id="970" class="Symbol">∀</a> <a id="972" class="Symbol">{</a><a id="973" href="Generic.Calculus.html#973" class="Bound">τ</a><a id="974" class="Symbol">}</a> <a id="976" class="Symbol">→</a> <a id="978" href="Generic.Calculus.html#Calculus.FConf" class="Field">FConf</a> <a id="984" href="Generic.Calculus.html#973" class="Bound">τ</a> <a id="986" class="Symbol">→</a> <a id="988" href="Lattice.Base.html#Label" class="Field">Label</a> <a id="994" class="Symbol">→</a> <a id="996" href="Generic.Bijection.html#Bij" class="Function">Bij</a> <a id="1000" class="Symbol">→</a> <a id="1002" href="Generic.Calculus.html#Calculus.FConf" class="Field">FConf</a> <a id="1008" href="Generic.Calculus.html#973" class="Bound">τ</a> <a id="1010" class="Symbol">→</a> <a id="1012" class="PrimitiveType">Set</a>

<a id="1017" class="Comment">-- TODO: here we could make the statement simpler (e.g., empty</a>
<a id="1080" class="Comment">-- memory/store, only boolean inputs, no assumptions about validity)</a>
<a id="1149" class="Comment">-- but this seems just more boring work.</a>

<a id="1191" class="Comment">-- Generic Termination-Insensitive Non-Interferencee property (TINI).</a>
<a id="TINI" href="Generic.Calculus.html#TINI" class="Function">TINI</a> <a id="1266" class="Symbol">:</a> <a id="1268" class="Symbol">∀</a> <a id="1270" class="Symbol">{{</a><a id="1272" href="Generic.Calculus.html#1272" class="Bound">𝑳</a> <a id="1274" class="Symbol">:</a> <a id="1276" href="Lattice.html#Lattice" class="Function">Lattice</a><a id="1283" class="Symbol">}}</a> <a id="1286" class="Symbol">→</a> <a id="1288" href="Generic.Calculus.html#Calculus" class="Record">Calculus</a> <a id="1297" class="Symbol">→</a> <a id="1299" class="PrimitiveType">Set</a>
<a id="1303" href="Generic.Calculus.html#TINI" class="Function">TINI</a> <a id="1308" href="Generic.Calculus.html#1308" class="Bound">𝑪</a> <a id="1310" class="Symbol">=</a> <a id="1312" class="Symbol">∀</a> <a id="1314" class="Symbol">{</a><a id="1315" href="Generic.Calculus.html#1315" class="Bound">τ</a> <a id="1317" href="Generic.Calculus.html#1317" class="Bound">Γ</a> <a id="1319" href="Generic.Calculus.html#1319" class="Bound">θ₁</a> <a id="1322" href="Generic.Calculus.html#1322" class="Bound">θ₂</a> <a id="1325" href="Generic.Calculus.html#1325" class="Bound">A</a> <a id="1327" href="Generic.Calculus.html#1327" class="Bound">β</a><a id="1328" class="Symbol">}</a> <a id="1330" class="Symbol">{</a><a id="1331" href="Generic.Calculus.html#1331" class="Bound">c₁</a> <a id="1334" href="Generic.Calculus.html#1334" class="Bound">c₂</a> <a id="1337" class="Symbol">:</a> <a id="1339" href="Generic.Calculus.html#534" class="Field">IConf</a> <a id="1345" href="Generic.Calculus.html#1317" class="Bound">Γ</a> <a id="1347" href="Generic.Calculus.html#593" class="Field Operator">I⟨</a> <a id="1350" href="Generic.Calculus.html#1315" class="Bound">τ</a> <a id="1352" href="Generic.Calculus.html#593" class="Field Operator">⟩</a><a id="1353" class="Symbol">}</a> <a id="1355" class="Symbol">{</a><a id="1356" href="Generic.Calculus.html#1356" class="Bound">c₁&#39;</a> <a id="1360" href="Generic.Calculus.html#1360" class="Bound">c₂&#39;</a> <a id="1364" class="Symbol">:</a> <a id="1366" href="Generic.Calculus.html#568" class="Field">FConf</a> <a id="1372" href="Generic.Calculus.html#1315" class="Bound">τ</a><a id="1373" class="Symbol">}</a> <a id="1375" class="Symbol">→</a>
              <a id="1391" href="Generic.Calculus.html#730" class="Field">Valid-Inputs</a> <a id="1404" href="Generic.Calculus.html#1331" class="Bound">c₁</a> <a id="1407" href="Generic.Calculus.html#1319" class="Bound">θ₁</a> <a id="1410" class="Symbol">→</a>
              <a id="1426" href="Generic.Calculus.html#730" class="Field">Valid-Inputs</a> <a id="1439" href="Generic.Calculus.html#1334" class="Bound">c₂</a> <a id="1442" href="Generic.Calculus.html#1322" class="Bound">θ₂</a> <a id="1445" class="Symbol">→</a>
              <a id="1461" href="Generic.Calculus.html#1331" class="Bound">c₁</a> <a id="1464" href="Generic.Calculus.html#662" class="Field Operator">⇓⟨</a> <a id="1467" href="Generic.Calculus.html#1319" class="Bound">θ₁</a> <a id="1470" href="Generic.Calculus.html#662" class="Field Operator">⟩</a> <a id="1472" href="Generic.Calculus.html#1356" class="Bound">c₁&#39;</a> <a id="1476" class="Symbol">→</a>
              <a id="1492" href="Generic.Calculus.html#1334" class="Bound">c₂</a> <a id="1495" href="Generic.Calculus.html#662" class="Field Operator">⇓⟨</a> <a id="1498" href="Generic.Calculus.html#1322" class="Bound">θ₂</a> <a id="1501" href="Generic.Calculus.html#662" class="Field Operator">⟩</a> <a id="1503" href="Generic.Calculus.html#1360" class="Bound">c₂&#39;</a> <a id="1507" class="Symbol">→</a>
              <a id="1523" href="Generic.Calculus.html#1331" class="Bound">c₁</a> <a id="1526" href="Generic.Calculus.html#886" class="Field Operator">≈ᴵ⟨</a> <a id="1530" href="Generic.Calculus.html#1325" class="Bound">A</a> <a id="1532" href="Generic.Calculus.html#886" class="Field Operator">,</a> <a id="1534" href="Generic.Calculus.html#1327" class="Bound">β</a> <a id="1536" href="Generic.Calculus.html#886" class="Field Operator">⟩</a> <a id="1538" href="Generic.Calculus.html#1334" class="Bound">c₂</a> <a id="1541" class="Symbol">→</a>
              <a id="1557" href="Generic.Calculus.html#1319" class="Bound">θ₁</a> <a id="1560" href="Generic.Calculus.html#820" class="Field Operator">≈ᴱ⟨</a> <a id="1564" href="Generic.Calculus.html#1325" class="Bound">A</a> <a id="1566" href="Generic.Calculus.html#820" class="Field Operator">,</a> <a id="1568" href="Generic.Calculus.html#1327" class="Bound">β</a> <a id="1570" href="Generic.Calculus.html#820" class="Field Operator">⟩</a> <a id="1572" href="Generic.Calculus.html#1322" class="Bound">θ₂</a> <a id="1575" class="Symbol">→</a>
              <a id="1591" href="Data.Product.html#%E2%88%83" class="Function">∃</a> <a id="1593" class="Symbol">(λ</a> <a id="1596" href="Generic.Calculus.html#1596" class="Bound">β&#39;</a> <a id="1599" class="Symbol">→</a> <a id="1601" href="Generic.Calculus.html#1327" class="Bound">β</a> <a id="1603" href="Generic.Partial.Bijection.html#_%E2%8A%86_" class="Record Operator">⊆</a> <a id="1605" href="Generic.Calculus.html#1596" class="Bound">β&#39;</a> <a id="1608" href="Data.Product.html#_%C3%97_" class="Function Operator">×</a> <a id="1610" href="Generic.Calculus.html#1356" class="Bound">c₁&#39;</a> <a id="1614" href="Generic.Calculus.html#958" class="Field Operator">≈ᶠ⟨</a> <a id="1618" href="Generic.Calculus.html#1325" class="Bound">A</a> <a id="1620" href="Generic.Calculus.html#958" class="Field Operator">,</a> <a id="1622" href="Generic.Calculus.html#1596" class="Bound">β&#39;</a> <a id="1625" href="Generic.Calculus.html#958" class="Field Operator">⟩</a> <a id="1627" href="Generic.Calculus.html#1360" class="Bound">c₂&#39;</a><a id="1630" class="Symbol">)</a>
     <a id="1637" class="Keyword">where</a> <a id="1643" class="Keyword">open</a> <a id="1648" href="Generic.Calculus.html#Calculus" class="Module">Calculus</a> <a id="1657" href="Generic.Calculus.html#1308" class="Bound">𝑪</a>
           <a id="1670" class="Keyword">open</a> <a id="1675" class="Keyword">import</a> <a id="1682" href="Data.Product.html" class="Module">Data.Product</a> <a id="1695" class="Keyword">using</a> <a id="1701" class="Symbol">(</a><a id="1702" href="Data.Product.html#_%C3%97_" class="Function Operator">_×_</a> <a id="1706" class="Symbol">;</a> <a id="1708" href="Data.Product.html#%E2%88%83" class="Function">∃</a><a id="1709" class="Symbol">)</a>
</pre></body></html>