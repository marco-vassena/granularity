<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>CG.Syntax</title><link rel="stylesheet" href="Agda.css"></head><body><pre><a id="1" class="Comment">-- Well-typed syntax</a>

<a id="23" class="Keyword">open</a> <a id="28" class="Keyword">import</a> <a id="35" href="Lattice.html" class="Module">Lattice</a>

<a id="44" class="Keyword">module</a> <a id="51" href="CG.Syntax.html" class="Module">CG.Syntax</a> <a id="61" class="Symbol">{{</a><a id="63" href="CG.Syntax.html#63" class="Bound">𝑳</a> <a id="65" class="Symbol">:</a> <a id="67" href="Lattice.html#Lattice" class="Function">Lattice</a><a id="74" class="Symbol">}}</a> <a id="77" class="Keyword">where</a>

<a id="84" class="Keyword">open</a> <a id="89" class="Keyword">import</a> <a id="96" href="CG.Types.html" class="Module">CG.Types</a>
<a id="105" class="Keyword">open</a> <a id="110" class="Keyword">import</a> <a id="117" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="126" class="Keyword">using</a> <a id="132" class="Symbol">(</a><a id="133" href="Agda.Builtin.Nat.html#Nat" class="Datatype">ℕ</a><a id="134" class="Symbol">)</a>

<a id="137" class="Keyword">mutual</a>

  <a id="147" class="Comment">-- (e : Expr Γ τ) represents a term t of type τ in the context Γ,</a>
  <a id="215" class="Comment">-- i.e., Γ ⊢ t ∷ τ. Note that this definition merges syntax and tpying</a>
  <a id="288" class="Comment">-- judgment: only well-typed terms can be constructed with it.</a>
  <a id="353" class="Keyword">data</a> <a id="Expr" href="CG.Syntax.html#Expr" class="Datatype">Expr</a> <a id="363" class="Symbol">(</a><a id="364" href="CG.Syntax.html#364" class="Bound">Γ</a> <a id="366" class="Symbol">:</a> <a id="368" href="Generic.Context.Base.html#Ctx" class="Function">Ctx</a><a id="371" class="Symbol">)</a> <a id="373" class="Symbol">:</a> <a id="375" href="CG.Types.html#Ty" class="Datatype">Ty</a> <a id="378" class="Symbol">→</a> <a id="380" class="PrimitiveType">Set</a> <a id="384" class="Keyword">where</a>

    <a id="395" class="Comment">-- Unit</a>
    <a id="Expr.（）" href="CG.Syntax.html#Expr.%EF%BC%88%EF%BC%89" class="InductiveConstructor">（）</a> <a id="410" class="Symbol">:</a> <a id="412" href="CG.Syntax.html#Expr" class="Datatype">Expr</a> <a id="417" href="CG.Syntax.html#364" class="Bound">Γ</a> <a id="419" href="CG.Types.html#Ty.unit" class="InductiveConstructor">unit</a>

    <a id="429" class="Comment">-- First class labels.</a>
    <a id="Expr.⌞_⌟" href="CG.Syntax.html#Expr.%E2%8C%9E_%E2%8C%9F" class="InductiveConstructor Operator">⌞_⌟</a> <a id="460" class="Symbol">:</a> <a id="462" class="Symbol">(</a><a id="463" href="CG.Syntax.html#463" class="Bound">ℓ</a> <a id="465" class="Symbol">:</a> <a id="467" href="Lattice.Base.html#Label" class="Field">Label</a><a id="472" class="Symbol">)</a> <a id="474" class="Symbol">→</a> <a id="476" href="CG.Syntax.html#Expr" class="Datatype">Expr</a> <a id="481" href="CG.Syntax.html#364" class="Bound">Γ</a> <a id="483" href="CG.Types.html#Ty.%F0%9D%93%9B" class="InductiveConstructor">𝓛</a>

    <a id="490" class="Comment">-- ℓ₁ ⊑-? ℓ₂ tests if ℓ₁ can flow to ℓ₂</a>
    <a id="Expr._⊑-?_" href="CG.Syntax.html#Expr._%E2%8A%91-%3F_" class="InductiveConstructor Operator">_⊑-?_</a> <a id="540" class="Symbol">:</a> <a id="542" href="CG.Syntax.html#Expr" class="Datatype">Expr</a> <a id="547" href="CG.Syntax.html#364" class="Bound">Γ</a> <a id="549" href="CG.Types.html#Ty.%F0%9D%93%9B" class="InductiveConstructor">𝓛</a> <a id="551" class="Symbol">→</a> <a id="553" href="CG.Syntax.html#Expr" class="Datatype">Expr</a> <a id="558" href="CG.Syntax.html#364" class="Bound">Γ</a> <a id="560" href="CG.Types.html#Ty.%F0%9D%93%9B" class="InductiveConstructor">𝓛</a> <a id="562" class="Symbol">→</a> <a id="564" href="CG.Syntax.html#Expr" class="Datatype">Expr</a> <a id="569" href="CG.Syntax.html#364" class="Bound">Γ</a> <a id="571" href="CG.Types.html#Bool" class="Function">Bool</a>

    <a id="581" class="Comment">--------------------------------------------------------------------------------</a>
    <a id="666" class="Comment">-- Basic λ-calculus</a>

    <a id="691" class="Comment">-- Variables with De Bruijn indexes</a>
    <a id="Expr.var" href="CG.Syntax.html#Expr.var" class="InductiveConstructor">var</a> <a id="735" class="Symbol">:</a> <a id="737" class="Symbol">∀</a> <a id="739" class="Symbol">{</a><a id="740" href="CG.Syntax.html#740" class="Bound">τ</a><a id="741" class="Symbol">}</a> <a id="743" class="Symbol">→</a>  <a id="746" class="Symbol">(</a><a id="747" href="CG.Syntax.html#747" class="Bound">τ∈Γ</a> <a id="751" class="Symbol">:</a> <a id="753" href="CG.Syntax.html#740" class="Bound">τ</a> <a id="755" href="Data.List.Any.Membership.html#_%E2%88%88_" class="Function Operator">∈</a> <a id="757" href="CG.Syntax.html#364" class="Bound">Γ</a><a id="758" class="Symbol">)</a> <a id="760" class="Symbol">→</a> <a id="762" href="CG.Syntax.html#Expr" class="Datatype">Expr</a> <a id="767" href="CG.Syntax.html#364" class="Bound">Γ</a> <a id="769" href="CG.Syntax.html#740" class="Bound">τ</a>

    <a id="776" class="Comment">-- Functions</a>
    <a id="Expr.Λ" href="CG.Syntax.html#Expr.%CE%9B" class="InductiveConstructor">Λ</a> <a id="795" class="Symbol">:</a> <a id="797" class="Symbol">∀</a> <a id="799" class="Symbol">{</a><a id="800" href="CG.Syntax.html#800" class="Bound">τ₁</a> <a id="803" href="CG.Syntax.html#803" class="Bound">τ₂</a><a id="805" class="Symbol">}</a> <a id="807" class="Symbol">→</a> <a id="809" href="CG.Syntax.html#Expr" class="Datatype">Expr</a> <a id="814" class="Symbol">(</a><a id="815" href="CG.Syntax.html#800" class="Bound">τ₁</a> <a id="818" href="Agda.Builtin.List.html#_%E2%88%B7_" class="InductiveConstructor Operator">∷</a> <a id="820" href="CG.Syntax.html#364" class="Bound">Γ</a><a id="821" class="Symbol">)</a> <a id="823" href="CG.Syntax.html#803" class="Bound">τ₂</a> <a id="826" class="Symbol">→</a> <a id="828" href="CG.Syntax.html#Expr" class="Datatype">Expr</a> <a id="833" href="CG.Syntax.html#364" class="Bound">Γ</a> <a id="835" class="Symbol">(</a><a id="836" href="CG.Syntax.html#800" class="Bound">τ₁</a> <a id="839" href="CG.Types.html#Ty._%E2%9E%94_" class="InductiveConstructor Operator">➔</a> <a id="841" href="CG.Syntax.html#803" class="Bound">τ₂</a><a id="843" class="Symbol">)</a>

    <a id="850" class="Comment">-- Function application</a>
    <a id="Expr._∘_" href="CG.Syntax.html#Expr._%E2%88%98_" class="InductiveConstructor Operator">_∘_</a> <a id="882" class="Symbol">:</a> <a id="884" class="Symbol">∀</a> <a id="886" class="Symbol">{</a><a id="887" href="CG.Syntax.html#887" class="Bound">τ₁</a> <a id="890" href="CG.Syntax.html#890" class="Bound">τ₂</a><a id="892" class="Symbol">}</a> <a id="894" class="Symbol">→</a> <a id="896" href="CG.Syntax.html#Expr" class="Datatype">Expr</a> <a id="901" href="CG.Syntax.html#364" class="Bound">Γ</a> <a id="903" class="Symbol">(</a><a id="904" href="CG.Syntax.html#887" class="Bound">τ₁</a> <a id="907" href="CG.Types.html#Ty._%E2%9E%94_" class="InductiveConstructor Operator">➔</a> <a id="909" href="CG.Syntax.html#890" class="Bound">τ₂</a><a id="911" class="Symbol">)</a> <a id="913" class="Symbol">→</a> <a id="915" href="CG.Syntax.html#Expr" class="Datatype">Expr</a> <a id="920" href="CG.Syntax.html#364" class="Bound">Γ</a> <a id="922" href="CG.Syntax.html#887" class="Bound">τ₁</a> <a id="925" class="Symbol">→</a> <a id="927" href="CG.Syntax.html#Expr" class="Datatype">Expr</a> <a id="932" href="CG.Syntax.html#364" class="Bound">Γ</a> <a id="934" href="CG.Syntax.html#890" class="Bound">τ₂</a>

    <a id="942" class="Comment">--------------------------------------------------------------------------------</a>
    <a id="1027" class="Comment">-- Pairs</a>

    <a id="Expr.⟨_,_⟩" href="CG.Syntax.html#Expr.%E2%9F%A8_%2C_%E2%9F%A9" class="InductiveConstructor Operator">⟨_,_⟩</a> <a id="1047" class="Symbol">:</a> <a id="1049" class="Symbol">∀</a> <a id="1051" class="Symbol">{</a><a id="1052" href="CG.Syntax.html#1052" class="Bound">τ₁</a> <a id="1055" href="CG.Syntax.html#1055" class="Bound">τ₂</a><a id="1057" class="Symbol">}</a> <a id="1059" class="Symbol">→</a> <a id="1061" href="CG.Syntax.html#Expr" class="Datatype">Expr</a> <a id="1066" href="CG.Syntax.html#364" class="Bound">Γ</a> <a id="1068" href="CG.Syntax.html#1052" class="Bound">τ₁</a> <a id="1071" class="Symbol">→</a> <a id="1073" href="CG.Syntax.html#Expr" class="Datatype">Expr</a> <a id="1078" href="CG.Syntax.html#364" class="Bound">Γ</a> <a id="1080" href="CG.Syntax.html#1055" class="Bound">τ₂</a> <a id="1083" class="Symbol">→</a> <a id="1085" href="CG.Syntax.html#Expr" class="Datatype">Expr</a> <a id="1090" href="CG.Syntax.html#364" class="Bound">Γ</a> <a id="1092" class="Symbol">(</a><a id="1093" href="CG.Syntax.html#1052" class="Bound">τ₁</a> <a id="1096" href="CG.Types.html#Ty._%C3%97_" class="InductiveConstructor Operator">×</a> <a id="1098" href="CG.Syntax.html#1055" class="Bound">τ₂</a><a id="1100" class="Symbol">)</a>

    <a id="Expr.fst" href="CG.Syntax.html#Expr.fst" class="InductiveConstructor">fst</a> <a id="1111" class="Symbol">:</a> <a id="1113" class="Symbol">∀</a> <a id="1115" class="Symbol">{</a><a id="1116" href="CG.Syntax.html#1116" class="Bound">τ₁</a> <a id="1119" href="CG.Syntax.html#1119" class="Bound">τ₂</a><a id="1121" class="Symbol">}</a> <a id="1123" class="Symbol">→</a> <a id="1125" href="CG.Syntax.html#Expr" class="Datatype">Expr</a> <a id="1130" href="CG.Syntax.html#364" class="Bound">Γ</a> <a id="1132" class="Symbol">(</a><a id="1133" href="CG.Syntax.html#1116" class="Bound">τ₁</a> <a id="1136" href="CG.Types.html#Ty._%C3%97_" class="InductiveConstructor Operator">×</a> <a id="1138" href="CG.Syntax.html#1119" class="Bound">τ₂</a><a id="1140" class="Symbol">)</a> <a id="1142" class="Symbol">→</a> <a id="1144" href="CG.Syntax.html#Expr" class="Datatype">Expr</a> <a id="1149" href="CG.Syntax.html#364" class="Bound">Γ</a> <a id="1151" href="CG.Syntax.html#1116" class="Bound">τ₁</a>

    <a id="Expr.snd" href="CG.Syntax.html#Expr.snd" class="InductiveConstructor">snd</a> <a id="1163" class="Symbol">:</a> <a id="1165" class="Symbol">∀</a> <a id="1167" class="Symbol">{</a><a id="1168" href="CG.Syntax.html#1168" class="Bound">τ₁</a> <a id="1171" href="CG.Syntax.html#1171" class="Bound">τ₂</a><a id="1173" class="Symbol">}</a> <a id="1175" class="Symbol">→</a> <a id="1177" href="CG.Syntax.html#Expr" class="Datatype">Expr</a> <a id="1182" href="CG.Syntax.html#364" class="Bound">Γ</a> <a id="1184" class="Symbol">(</a><a id="1185" href="CG.Syntax.html#1168" class="Bound">τ₁</a> <a id="1188" href="CG.Types.html#Ty._%C3%97_" class="InductiveConstructor Operator">×</a> <a id="1190" href="CG.Syntax.html#1171" class="Bound">τ₂</a><a id="1192" class="Symbol">)</a> <a id="1194" class="Symbol">→</a> <a id="1196" href="CG.Syntax.html#Expr" class="Datatype">Expr</a> <a id="1201" href="CG.Syntax.html#364" class="Bound">Γ</a> <a id="1203" href="CG.Syntax.html#1171" class="Bound">τ₂</a>

    <a id="1211" class="Comment">--------------------------------------------------------------------------------</a>
    <a id="1296" class="Comment">-- Sum</a>

    <a id="Expr.inl" href="CG.Syntax.html#Expr.inl" class="InductiveConstructor">inl</a> <a id="1312" class="Symbol">:</a> <a id="1314" class="Symbol">∀</a> <a id="1316" class="Symbol">{</a><a id="1317" href="CG.Syntax.html#1317" class="Bound">τ₁</a> <a id="1320" href="CG.Syntax.html#1320" class="Bound">τ₂</a><a id="1322" class="Symbol">}</a> <a id="1324" class="Symbol">→</a> <a id="1326" href="CG.Syntax.html#Expr" class="Datatype">Expr</a> <a id="1331" href="CG.Syntax.html#364" class="Bound">Γ</a> <a id="1333" href="CG.Syntax.html#1317" class="Bound">τ₁</a> <a id="1336" class="Symbol">→</a> <a id="1338" href="CG.Syntax.html#Expr" class="Datatype">Expr</a> <a id="1343" href="CG.Syntax.html#364" class="Bound">Γ</a> <a id="1345" class="Symbol">(</a><a id="1346" href="CG.Syntax.html#1317" class="Bound">τ₁</a> <a id="1349" href="CG.Types.html#Ty._%2B_" class="InductiveConstructor Operator">+</a> <a id="1351" href="CG.Syntax.html#1320" class="Bound">τ₂</a><a id="1353" class="Symbol">)</a>

    <a id="Expr.inr" href="CG.Syntax.html#Expr.inr" class="InductiveConstructor">inr</a> <a id="1364" class="Symbol">:</a> <a id="1366" class="Symbol">∀</a> <a id="1368" class="Symbol">{</a><a id="1369" href="CG.Syntax.html#1369" class="Bound">τ₁</a> <a id="1372" href="CG.Syntax.html#1372" class="Bound">τ₂</a><a id="1374" class="Symbol">}</a> <a id="1376" class="Symbol">→</a> <a id="1378" href="CG.Syntax.html#Expr" class="Datatype">Expr</a> <a id="1383" href="CG.Syntax.html#364" class="Bound">Γ</a> <a id="1385" href="CG.Syntax.html#1372" class="Bound">τ₂</a> <a id="1388" class="Symbol">→</a> <a id="1390" href="CG.Syntax.html#Expr" class="Datatype">Expr</a> <a id="1395" href="CG.Syntax.html#364" class="Bound">Γ</a> <a id="1397" class="Symbol">(</a><a id="1398" href="CG.Syntax.html#1369" class="Bound">τ₁</a> <a id="1401" href="CG.Types.html#Ty._%2B_" class="InductiveConstructor Operator">+</a> <a id="1403" href="CG.Syntax.html#1372" class="Bound">τ₂</a><a id="1405" class="Symbol">)</a>

    <a id="Expr.case" href="CG.Syntax.html#Expr.case" class="InductiveConstructor">case</a> <a id="1417" class="Symbol">:</a> <a id="1419" class="Symbol">∀</a> <a id="1421" class="Symbol">{</a><a id="1422" href="CG.Syntax.html#1422" class="Bound">τ₁</a> <a id="1425" href="CG.Syntax.html#1425" class="Bound">τ₂</a> <a id="1428" href="CG.Syntax.html#1428" class="Bound">τ₃</a><a id="1430" class="Symbol">}</a> <a id="1432" class="Symbol">→</a> <a id="1434" href="CG.Syntax.html#Expr" class="Datatype">Expr</a> <a id="1439" href="CG.Syntax.html#364" class="Bound">Γ</a> <a id="1441" class="Symbol">(</a><a id="1442" href="CG.Syntax.html#1422" class="Bound">τ₁</a> <a id="1445" href="CG.Types.html#Ty._%2B_" class="InductiveConstructor Operator">+</a> <a id="1447" href="CG.Syntax.html#1425" class="Bound">τ₂</a><a id="1449" class="Symbol">)</a> <a id="1451" class="Symbol">→</a> <a id="1453" href="CG.Syntax.html#Expr" class="Datatype">Expr</a> <a id="1458" class="Symbol">(</a><a id="1459" href="CG.Syntax.html#1422" class="Bound">τ₁</a> <a id="1462" href="Agda.Builtin.List.html#_%E2%88%B7_" class="InductiveConstructor Operator">∷</a> <a id="1464" href="CG.Syntax.html#364" class="Bound">Γ</a><a id="1465" class="Symbol">)</a> <a id="1467" href="CG.Syntax.html#1428" class="Bound">τ₃</a> <a id="1470" class="Symbol">→</a> <a id="1472" href="CG.Syntax.html#Expr" class="Datatype">Expr</a> <a id="1477" class="Symbol">(</a><a id="1478" href="CG.Syntax.html#1425" class="Bound">τ₂</a> <a id="1481" href="Agda.Builtin.List.html#_%E2%88%B7_" class="InductiveConstructor Operator">∷</a> <a id="1483" href="CG.Syntax.html#364" class="Bound">Γ</a><a id="1484" class="Symbol">)</a> <a id="1486" href="CG.Syntax.html#1428" class="Bound">τ₃</a> <a id="1489" class="Symbol">→</a> <a id="1491" href="CG.Syntax.html#Expr" class="Datatype">Expr</a> <a id="1496" href="CG.Syntax.html#364" class="Bound">Γ</a> <a id="1498" href="CG.Syntax.html#1428" class="Bound">τ₃</a>

    <a id="1506" class="Comment">--------------------------------------------------------------------------------</a>
    <a id="1591" class="Comment">-- Lifts a Thunk (LIO computation) to Expr.</a>

    <a id="Expr.⌞_⌟ᵀ" href="CG.Syntax.html#Expr.%E2%8C%9E_%E2%8C%9F%E1%B5%80" class="InductiveConstructor Operator">⌞_⌟ᵀ</a> <a id="1645" class="Symbol">:</a> <a id="1647" class="Symbol">∀</a> <a id="1649" class="Symbol">{</a><a id="1650" href="CG.Syntax.html#1650" class="Bound">τ</a><a id="1651" class="Symbol">}</a> <a id="1653" class="Symbol">→</a> <a id="1655" class="Symbol">(</a><a id="1656" href="CG.Syntax.html#1656" class="Bound">t</a> <a id="1658" class="Symbol">:</a> <a id="1660" href="CG.Syntax.html#Thunk" class="Datatype">Thunk</a> <a id="1666" href="CG.Syntax.html#364" class="Bound">Γ</a> <a id="1668" class="Symbol">(</a><a id="1669" href="CG.Types.html#Ty.LIO" class="InductiveConstructor">LIO</a> <a id="1673" href="CG.Syntax.html#1650" class="Bound">τ</a><a id="1674" class="Symbol">))</a> <a id="1677" class="Symbol">→</a> <a id="1679" href="CG.Syntax.html#Expr" class="Datatype">Expr</a> <a id="1684" href="CG.Syntax.html#364" class="Bound">Γ</a> <a id="1686" class="Symbol">(</a><a id="1687" href="CG.Types.html#Ty.LIO" class="InductiveConstructor">LIO</a> <a id="1691" href="CG.Syntax.html#1650" class="Bound">τ</a><a id="1692" class="Symbol">)</a>

    <a id="1699" class="Comment">--------------------------------------------------------------------------------</a>
    <a id="1784" class="Comment">-- Explicit weakening</a>

    <a id="Expr.wken" href="CG.Syntax.html#Expr.wken" class="InductiveConstructor">wken</a> <a id="1816" class="Symbol">:</a> <a id="1818" class="Symbol">∀</a> <a id="1820" class="Symbol">{</a><a id="1821" href="CG.Syntax.html#1821" class="Bound">τ</a> <a id="1823" href="CG.Syntax.html#1823" class="Bound">Γ&#39;</a><a id="1825" class="Symbol">}</a> <a id="1827" class="Symbol">→</a> <a id="1829" href="CG.Syntax.html#Expr" class="Datatype">Expr</a> <a id="1834" href="CG.Syntax.html#1823" class="Bound">Γ&#39;</a> <a id="1837" href="CG.Syntax.html#1821" class="Bound">τ</a> <a id="1839" class="Symbol">→</a> <a id="1841" href="CG.Syntax.html#1823" class="Bound">Γ&#39;</a> <a id="1844" href="Generic.Context.Base.html#_%E2%8A%86_" class="Datatype Operator">⊆</a> <a id="1846" href="CG.Syntax.html#364" class="Bound">Γ</a> <a id="1848" class="Symbol">→</a> <a id="1850" href="CG.Syntax.html#Expr" class="Datatype">Expr</a> <a id="1855" href="CG.Syntax.html#364" class="Bound">Γ</a> <a id="1857" href="CG.Syntax.html#1821" class="Bound">τ</a>

  <a id="1862" class="Comment">-- LIO monad</a>
  <a id="1877" class="Keyword">data</a> <a id="Thunk" href="CG.Syntax.html#Thunk" class="Datatype">Thunk</a> <a id="1888" class="Symbol">(</a><a id="1889" href="CG.Syntax.html#1889" class="Bound">Γ</a> <a id="1891" class="Symbol">:</a> <a id="1893" href="Generic.Context.Base.html#Ctx" class="Function">Ctx</a><a id="1896" class="Symbol">)</a> <a id="1898" class="Symbol">:</a> <a id="1900" href="CG.Types.html#Ty" class="Datatype">Ty</a> <a id="1903" class="Symbol">→</a> <a id="1905" class="PrimitiveType">Set</a> <a id="1909" class="Keyword">where</a>

    <a id="1920" class="Comment">-- Encapsulates a value in the monad</a>
    <a id="Thunk.return" href="CG.Syntax.html#Thunk.return" class="InductiveConstructor">return</a> <a id="1968" class="Symbol">:</a> <a id="1970" class="Symbol">∀</a> <a id="1972" class="Symbol">{</a><a id="1973" href="CG.Syntax.html#1973" class="Bound">τ</a><a id="1974" class="Symbol">}</a> <a id="1976" class="Symbol">→</a> <a id="1978" href="CG.Syntax.html#Expr" class="Datatype">Expr</a> <a id="1983" href="CG.Syntax.html#1889" class="Bound">Γ</a> <a id="1985" href="CG.Syntax.html#1973" class="Bound">τ</a> <a id="1987" class="Symbol">→</a> <a id="1989" href="CG.Syntax.html#Thunk" class="Datatype">Thunk</a> <a id="1995" href="CG.Syntax.html#1889" class="Bound">Γ</a> <a id="1997" class="Symbol">(</a><a id="1998" href="CG.Types.html#Ty.LIO" class="InductiveConstructor">LIO</a> <a id="2002" href="CG.Syntax.html#1973" class="Bound">τ</a><a id="2003" class="Symbol">)</a>

    <a id="2010" class="Comment">-- Monadic bind</a>
    <a id="Thunk.bind" href="CG.Syntax.html#Thunk.bind" class="InductiveConstructor">bind</a> <a id="2035" class="Symbol">:</a> <a id="2037" class="Symbol">∀</a> <a id="2039" class="Symbol">{</a><a id="2040" href="CG.Syntax.html#2040" class="Bound">τ₁</a> <a id="2043" href="CG.Syntax.html#2043" class="Bound">τ₂</a><a id="2045" class="Symbol">}</a> <a id="2047" class="Symbol">→</a> <a id="2049" href="CG.Syntax.html#Expr" class="Datatype">Expr</a> <a id="2054" href="CG.Syntax.html#1889" class="Bound">Γ</a> <a id="2056" class="Symbol">(</a><a id="2057" href="CG.Types.html#Ty.LIO" class="InductiveConstructor">LIO</a> <a id="2061" href="CG.Syntax.html#2040" class="Bound">τ₁</a><a id="2063" class="Symbol">)</a> <a id="2065" class="Symbol">→</a> <a id="2067" href="CG.Syntax.html#Expr" class="Datatype">Expr</a> <a id="2072" class="Symbol">(</a><a id="2073" href="CG.Syntax.html#2040" class="Bound">τ₁</a> <a id="2076" href="Agda.Builtin.List.html#_%E2%88%B7_" class="InductiveConstructor Operator">∷</a> <a id="2078" href="CG.Syntax.html#1889" class="Bound">Γ</a><a id="2079" class="Symbol">)</a> <a id="2081" class="Symbol">(</a><a id="2082" href="CG.Types.html#Ty.LIO" class="InductiveConstructor">LIO</a> <a id="2086" href="CG.Syntax.html#2043" class="Bound">τ₂</a><a id="2088" class="Symbol">)</a> <a id="2090" class="Symbol">→</a> <a id="2092" href="CG.Syntax.html#Thunk" class="Datatype">Thunk</a> <a id="2098" href="CG.Syntax.html#1889" class="Bound">Γ</a> <a id="2100" class="Symbol">(</a><a id="2101" href="CG.Types.html#Ty.LIO" class="InductiveConstructor">LIO</a> <a id="2105" href="CG.Syntax.html#2043" class="Bound">τ₂</a><a id="2107" class="Symbol">)</a>

    <a id="2114" class="Comment">--------------------------------------------------------------------------------</a>
    <a id="2199" class="Comment">-- Basic labeled values</a>

    <a id="2228" class="Comment">-- Unlabel a labeled value</a>
    <a id="Thunk.unlabel" href="CG.Syntax.html#Thunk.unlabel" class="InductiveConstructor">unlabel</a> <a id="2267" class="Symbol">:</a> <a id="2269" class="Symbol">∀</a> <a id="2271" class="Symbol">{</a><a id="2272" href="CG.Syntax.html#2272" class="Bound">τ</a><a id="2273" class="Symbol">}</a> <a id="2275" class="Symbol">→</a> <a id="2277" href="CG.Syntax.html#Expr" class="Datatype">Expr</a> <a id="2282" href="CG.Syntax.html#1889" class="Bound">Γ</a> <a id="2284" class="Symbol">(</a><a id="2285" href="CG.Types.html#Ty.Labeled" class="InductiveConstructor">Labeled</a> <a id="2293" href="CG.Syntax.html#2272" class="Bound">τ</a><a id="2294" class="Symbol">)</a> <a id="2296" class="Symbol">→</a> <a id="2298" href="CG.Syntax.html#Thunk" class="Datatype">Thunk</a> <a id="2304" href="CG.Syntax.html#1889" class="Bound">Γ</a> <a id="2306" class="Symbol">(</a><a id="2307" href="CG.Types.html#Ty.LIO" class="InductiveConstructor">LIO</a> <a id="2311" href="CG.Syntax.html#2272" class="Bound">τ</a><a id="2312" class="Symbol">)</a>

    <a id="2319" class="Comment">-- toLabeled creates a labeled value out of an LIO computation</a>
    <a id="Thunk.toLabeled" href="CG.Syntax.html#Thunk.toLabeled" class="InductiveConstructor">toLabeled</a> <a id="2396" class="Symbol">:</a> <a id="2398" class="Symbol">∀</a> <a id="2400" class="Symbol">{</a><a id="2401" href="CG.Syntax.html#2401" class="Bound">τ</a><a id="2402" class="Symbol">}</a> <a id="2404" class="Symbol">→</a> <a id="2406" href="CG.Syntax.html#Expr" class="Datatype">Expr</a> <a id="2411" href="CG.Syntax.html#1889" class="Bound">Γ</a> <a id="2413" class="Symbol">(</a><a id="2414" href="CG.Types.html#Ty.LIO" class="InductiveConstructor">LIO</a> <a id="2418" href="CG.Syntax.html#2401" class="Bound">τ</a><a id="2419" class="Symbol">)</a> <a id="2421" class="Symbol">→</a> <a id="2423" href="CG.Syntax.html#Thunk" class="Datatype">Thunk</a> <a id="2429" href="CG.Syntax.html#1889" class="Bound">Γ</a> <a id="2431" class="Symbol">(</a><a id="2432" href="CG.Types.html#Ty.LIO" class="InductiveConstructor">LIO</a> <a id="2436" class="Symbol">(</a><a id="2437" href="CG.Types.html#Ty.Labeled" class="InductiveConstructor">Labeled</a> <a id="2445" href="CG.Syntax.html#2401" class="Bound">τ</a><a id="2446" class="Symbol">))</a>

   <a id="2453" class="Comment">--------------------------------------------------------------------------------</a>
   <a id="2537" class="Comment">-- Label introspection.</a>

    <a id="2566" class="Comment">-- Retrieve the label of a labeled value</a>
    <a id="Thunk.labelOf" href="CG.Syntax.html#Thunk.labelOf" class="InductiveConstructor">labelOf</a> <a id="2619" class="Symbol">:</a> <a id="2621" class="Symbol">∀</a> <a id="2623" class="Symbol">{</a><a id="2624" href="CG.Syntax.html#2624" class="Bound">τ</a><a id="2625" class="Symbol">}</a> <a id="2627" class="Symbol">→</a> <a id="2629" href="CG.Syntax.html#Expr" class="Datatype">Expr</a> <a id="2634" href="CG.Syntax.html#1889" class="Bound">Γ</a> <a id="2636" class="Symbol">(</a><a id="2637" href="CG.Types.html#Ty.Labeled" class="InductiveConstructor">Labeled</a> <a id="2645" href="CG.Syntax.html#2624" class="Bound">τ</a><a id="2646" class="Symbol">)</a> <a id="2648" class="Symbol">→</a> <a id="2650" href="CG.Syntax.html#Thunk" class="Datatype">Thunk</a> <a id="2656" href="CG.Syntax.html#1889" class="Bound">Γ</a> <a id="2658" class="Symbol">(</a><a id="2659" href="CG.Types.html#Ty.LIO" class="InductiveConstructor">LIO</a> <a id="2663" href="CG.Types.html#Ty.%F0%9D%93%9B" class="InductiveConstructor">𝓛</a><a id="2664" class="Symbol">)</a>

    <a id="2671" class="Comment">-- Retrieve the current label of the context, i.e., the program counter</a>
    <a id="Thunk.getLabel" href="CG.Syntax.html#Thunk.getLabel" class="InductiveConstructor">getLabel</a> <a id="2756" class="Symbol">:</a> <a id="2758" href="CG.Syntax.html#Thunk" class="Datatype">Thunk</a> <a id="2764" href="CG.Syntax.html#1889" class="Bound">Γ</a> <a id="2766" class="Symbol">(</a><a id="2767" href="CG.Types.html#Ty.LIO" class="InductiveConstructor">LIO</a> <a id="2771" href="CG.Types.html#Ty.%F0%9D%93%9B" class="InductiveConstructor">𝓛</a><a id="2772" class="Symbol">)</a>

    <a id="2779" class="Comment">-- taint(ℓ) raises the program counter to ℓ</a>
    <a id="Thunk.taint" href="CG.Syntax.html#Thunk.taint" class="InductiveConstructor">taint</a> <a id="2833" class="Symbol">:</a> <a id="2835" href="CG.Syntax.html#Expr" class="Datatype">Expr</a> <a id="2840" href="CG.Syntax.html#1889" class="Bound">Γ</a> <a id="2842" href="CG.Types.html#Ty.%F0%9D%93%9B" class="InductiveConstructor">𝓛</a> <a id="2844" class="Symbol">→</a> <a id="2846" href="CG.Syntax.html#Thunk" class="Datatype">Thunk</a> <a id="2852" href="CG.Syntax.html#1889" class="Bound">Γ</a> <a id="2854" class="Symbol">(</a><a id="2855" href="CG.Types.html#Ty.LIO" class="InductiveConstructor">LIO</a> <a id="2859" href="CG.Types.html#Ty.unit" class="InductiveConstructor">unit</a><a id="2863" class="Symbol">)</a>

   <a id="2869" class="Comment">--------------------------------------------------------------------------------</a>
   <a id="2953" class="Comment">-- Memory operations.</a>

    <a id="2980" class="Comment">-- Creates a new mutable reference at a given security level</a>
    <a id="Thunk.new" href="CG.Syntax.html#Thunk.new" class="InductiveConstructor">new</a> <a id="3049" class="Symbol">:</a> <a id="3051" class="Symbol">∀</a> <a id="3053" class="Symbol">{</a><a id="3054" href="CG.Syntax.html#3054" class="Bound">τ</a><a id="3055" class="Symbol">}</a> <a id="3057" class="Symbol">→</a> <a id="3059" href="CG.Syntax.html#Expr" class="Datatype">Expr</a> <a id="3064" href="CG.Syntax.html#1889" class="Bound">Γ</a> <a id="3066" class="Symbol">(</a><a id="3067" href="CG.Types.html#Ty.Labeled" class="InductiveConstructor">Labeled</a> <a id="3075" href="CG.Syntax.html#3054" class="Bound">τ</a><a id="3076" class="Symbol">)</a> <a id="3078" class="Symbol">→</a> <a id="3080" href="CG.Syntax.html#Thunk" class="Datatype">Thunk</a> <a id="3086" href="CG.Syntax.html#1889" class="Bound">Γ</a> <a id="3088" class="Symbol">(</a><a id="3089" href="CG.Types.html#Ty.LIO" class="InductiveConstructor">LIO</a> <a id="3093" class="Symbol">(</a><a id="3094" href="CG.Types.html#Ty.Ref" class="InductiveConstructor">Ref</a> <a id="3098" href="CG.Syntax.html#3054" class="Bound">τ</a><a id="3099" class="Symbol">))</a>

    <a id="3107" class="Comment">-- Reads the content of a mutable reference</a>
    <a id="Thunk.!_" href="CG.Syntax.html#Thunk.%21_" class="InductiveConstructor Operator">!_</a> <a id="3158" class="Symbol">:</a> <a id="3160" class="Symbol">∀</a> <a id="3162" class="Symbol">{</a><a id="3163" href="CG.Syntax.html#3163" class="Bound">τ</a><a id="3164" class="Symbol">}</a> <a id="3166" class="Symbol">→</a> <a id="3168" href="CG.Syntax.html#Expr" class="Datatype">Expr</a> <a id="3173" href="CG.Syntax.html#1889" class="Bound">Γ</a> <a id="3175" class="Symbol">(</a><a id="3176" href="CG.Types.html#Ty.Ref" class="InductiveConstructor">Ref</a> <a id="3180" href="CG.Syntax.html#3163" class="Bound">τ</a><a id="3181" class="Symbol">)</a> <a id="3183" class="Symbol">→</a> <a id="3185" href="CG.Syntax.html#Thunk" class="Datatype">Thunk</a> <a id="3191" href="CG.Syntax.html#1889" class="Bound">Γ</a> <a id="3193" class="Symbol">(</a><a id="3194" href="CG.Types.html#Ty.LIO" class="InductiveConstructor">LIO</a> <a id="3198" href="CG.Syntax.html#3163" class="Bound">τ</a><a id="3199" class="Symbol">)</a>

    <a id="3206" class="Comment">-- Overvwrites the content of a mutable reference</a>
    <a id="Thunk._≔_" href="CG.Syntax.html#Thunk._%E2%89%94_" class="InductiveConstructor Operator">_≔_</a> <a id="3264" class="Symbol">:</a> <a id="3266" class="Symbol">∀</a> <a id="3268" class="Symbol">{</a><a id="3269" href="CG.Syntax.html#3269" class="Bound">τ</a><a id="3270" class="Symbol">}</a> <a id="3272" class="Symbol">→</a> <a id="3274" href="CG.Syntax.html#Expr" class="Datatype">Expr</a> <a id="3279" href="CG.Syntax.html#1889" class="Bound">Γ</a> <a id="3281" class="Symbol">(</a><a id="3282" href="CG.Types.html#Ty.Ref" class="InductiveConstructor">Ref</a> <a id="3286" href="CG.Syntax.html#3269" class="Bound">τ</a><a id="3287" class="Symbol">)</a> <a id="3289" class="Symbol">→</a> <a id="3291" href="CG.Syntax.html#Expr" class="Datatype">Expr</a> <a id="3296" href="CG.Syntax.html#1889" class="Bound">Γ</a> <a id="3298" class="Symbol">(</a><a id="3299" href="CG.Types.html#Ty.Labeled" class="InductiveConstructor">Labeled</a> <a id="3307" href="CG.Syntax.html#3269" class="Bound">τ</a><a id="3308" class="Symbol">)</a> <a id="3310" class="Symbol">→</a> <a id="3312" href="CG.Syntax.html#Thunk" class="Datatype">Thunk</a> <a id="3318" href="CG.Syntax.html#1889" class="Bound">Γ</a> <a id="3320" class="Symbol">(</a><a id="3321" href="CG.Types.html#Ty.LIO" class="InductiveConstructor">LIO</a> <a id="3325" href="CG.Types.html#Ty.unit" class="InductiveConstructor">unit</a><a id="3329" class="Symbol">)</a>

    <a id="3336" class="Comment">-- Retrieve the label of a labeled reference</a>
    <a id="Thunk.labelOfRef" href="CG.Syntax.html#Thunk.labelOfRef" class="InductiveConstructor">labelOfRef</a> <a id="3396" class="Symbol">:</a> <a id="3398" class="Symbol">∀</a> <a id="3400" class="Symbol">{</a><a id="3401" href="CG.Syntax.html#3401" class="Bound">τ</a><a id="3402" class="Symbol">}</a> <a id="3404" class="Symbol">→</a> <a id="3406" href="CG.Syntax.html#Expr" class="Datatype">Expr</a> <a id="3411" href="CG.Syntax.html#1889" class="Bound">Γ</a> <a id="3413" class="Symbol">(</a><a id="3414" href="CG.Types.html#Ty.Ref" class="InductiveConstructor">Ref</a> <a id="3418" href="CG.Syntax.html#3401" class="Bound">τ</a><a id="3419" class="Symbol">)</a> <a id="3421" class="Symbol">→</a> <a id="3423" href="CG.Syntax.html#Thunk" class="Datatype">Thunk</a> <a id="3429" href="CG.Syntax.html#1889" class="Bound">Γ</a> <a id="3431" class="Symbol">(</a><a id="3432" href="CG.Types.html#Ty.LIO" class="InductiveConstructor">LIO</a> <a id="3436" href="CG.Types.html#Ty.%F0%9D%93%9B" class="InductiveConstructor">𝓛</a><a id="3437" class="Symbol">)</a>

  <a id="3442" class="Comment">-- Value enviroment</a>
  <a id="3464" class="Keyword">data</a> <a id="Env" href="CG.Syntax.html#Env" class="Datatype">Env</a> <a id="3473" class="Symbol">:</a> <a id="3475" class="Symbol">(</a><a id="3476" href="CG.Syntax.html#3476" class="Bound">Γ</a> <a id="3478" class="Symbol">:</a> <a id="3480" href="Generic.Context.Base.html#Ctx" class="Function">Ctx</a><a id="3483" class="Symbol">)</a> <a id="3485" class="Symbol">→</a> <a id="3487" class="PrimitiveType">Set</a> <a id="3491" class="Keyword">where</a>
    <a id="Env.[]" href="CG.Syntax.html#Env.%5B%5D" class="InductiveConstructor">[]</a> <a id="3504" class="Symbol">:</a> <a id="3506" href="CG.Syntax.html#Env" class="Datatype">Env</a> <a id="3510" href="Agda.Builtin.List.html#%5B%5D" class="InductiveConstructor">[]</a>
    <a id="Env._∷_" href="CG.Syntax.html#Env._%E2%88%B7_" class="InductiveConstructor Operator">_∷_</a>  <a id="3522" class="Symbol">:</a> <a id="3524" class="Symbol">∀</a> <a id="3526" class="Symbol">{</a><a id="3527" href="CG.Syntax.html#3527" class="Bound">Γ</a> <a id="3529" href="CG.Syntax.html#3529" class="Bound">τ</a><a id="3530" class="Symbol">}</a> <a id="3532" class="Symbol">→</a> <a id="3534" class="Symbol">(</a><a id="3535" href="CG.Syntax.html#3535" class="Bound">v</a> <a id="3537" class="Symbol">:</a> <a id="3539" href="CG.Syntax.html#Value" class="Datatype">Value</a> <a id="3545" href="CG.Syntax.html#3529" class="Bound">τ</a><a id="3546" class="Symbol">)</a> <a id="3548" class="Symbol">(</a><a id="3549" href="CG.Syntax.html#3549" class="Bound">θ</a> <a id="3551" class="Symbol">:</a> <a id="3553" href="CG.Syntax.html#Env" class="Datatype">Env</a> <a id="3557" href="CG.Syntax.html#3527" class="Bound">Γ</a><a id="3558" class="Symbol">)</a> <a id="3560" class="Symbol">→</a> <a id="3562" href="CG.Syntax.html#Env" class="Datatype">Env</a> <a id="3566" class="Symbol">(</a><a id="3567" href="CG.Syntax.html#3529" class="Bound">τ</a> <a id="3569" href="Agda.Builtin.List.html#_%E2%88%B7_" class="InductiveConstructor Operator">∷</a> <a id="3571" href="CG.Syntax.html#3527" class="Bound">Γ</a><a id="3572" class="Symbol">)</a>

  <a id="3577" class="Comment">-- Value.</a>
  <a id="3589" class="Keyword">data</a> <a id="Value" href="CG.Syntax.html#Value" class="Datatype">Value</a> <a id="3600" class="Symbol">:</a> <a id="3602" href="CG.Types.html#Ty" class="Datatype">Ty</a> <a id="3605" class="Symbol">→</a> <a id="3607" class="PrimitiveType">Set</a> <a id="3611" class="Keyword">where</a>

    <a id="Value.（）" href="CG.Syntax.html#Value.%EF%BC%88%EF%BC%89" class="InductiveConstructor">（）</a> <a id="3625" class="Symbol">:</a> <a id="3627" href="CG.Syntax.html#Value" class="Datatype">Value</a> <a id="3633" href="CG.Types.html#Ty.unit" class="InductiveConstructor">unit</a>

    <a id="3643" class="Comment">-- Function closure</a>
    <a id="Value.⟨_,_⟩ᶜ" href="CG.Syntax.html#Value.%E2%9F%A8_%2C_%E2%9F%A9%E1%B6%9C" class="InductiveConstructor Operator">⟨_,_⟩ᶜ</a> <a id="3674" class="Symbol">:</a> <a id="3676" class="Symbol">∀</a> <a id="3678" class="Symbol">{</a><a id="3679" href="CG.Syntax.html#3679" class="Bound">Γ</a> <a id="3681" href="CG.Syntax.html#3681" class="Bound">τ₁</a> <a id="3684" href="CG.Syntax.html#3684" class="Bound">τ₂</a><a id="3686" class="Symbol">}</a> <a id="3688" class="Symbol">→</a> <a id="3690" class="Symbol">(</a><a id="3691" href="CG.Syntax.html#3691" class="Bound">e</a> <a id="3693" class="Symbol">:</a> <a id="3695" href="CG.Syntax.html#Expr" class="Datatype">Expr</a> <a id="3700" class="Symbol">(</a><a id="3701" href="CG.Syntax.html#3681" class="Bound">τ₁</a> <a id="3704" href="Agda.Builtin.List.html#_%E2%88%B7_" class="InductiveConstructor Operator">∷</a> <a id="3706" href="CG.Syntax.html#3679" class="Bound">Γ</a><a id="3707" class="Symbol">)</a> <a id="3709" href="CG.Syntax.html#3684" class="Bound">τ₂</a><a id="3711" class="Symbol">)</a> <a id="3713" class="Symbol">(</a><a id="3714" href="CG.Syntax.html#3714" class="Bound">θ</a> <a id="3716" class="Symbol">:</a> <a id="3718" href="CG.Syntax.html#Env" class="Datatype">Env</a> <a id="3722" href="CG.Syntax.html#3679" class="Bound">Γ</a><a id="3723" class="Symbol">)</a> <a id="3725" class="Symbol">→</a> <a id="3727" href="CG.Syntax.html#Value" class="Datatype">Value</a> <a id="3733" class="Symbol">(</a><a id="3734" href="CG.Syntax.html#3681" class="Bound">τ₁</a> <a id="3737" href="CG.Types.html#Ty._%E2%9E%94_" class="InductiveConstructor Operator">➔</a> <a id="3739" href="CG.Syntax.html#3684" class="Bound">τ₂</a><a id="3741" class="Symbol">)</a>

    <a id="3748" class="Comment">-- Thunk closure</a>
    <a id="Value.⟨_,_⟩ᵀ" href="CG.Syntax.html#Value.%E2%9F%A8_%2C_%E2%9F%A9%E1%B5%80" class="InductiveConstructor Operator">⟨_,_⟩ᵀ</a> <a id="3776" class="Symbol">:</a> <a id="3778" class="Symbol">∀</a> <a id="3780" class="Symbol">{</a><a id="3781" href="CG.Syntax.html#3781" class="Bound">Γ</a> <a id="3783" href="CG.Syntax.html#3783" class="Bound">τ</a><a id="3784" class="Symbol">}</a> <a id="3786" class="Symbol">→</a> <a id="3788" class="Symbol">(</a><a id="3789" href="CG.Syntax.html#3789" class="Bound">t</a> <a id="3791" class="Symbol">:</a> <a id="3793" href="CG.Syntax.html#Thunk" class="Datatype">Thunk</a> <a id="3799" href="CG.Syntax.html#3781" class="Bound">Γ</a> <a id="3801" class="Symbol">(</a><a id="3802" href="CG.Types.html#Ty.LIO" class="InductiveConstructor">LIO</a> <a id="3806" href="CG.Syntax.html#3783" class="Bound">τ</a><a id="3807" class="Symbol">))</a> <a id="3810" class="Symbol">(</a><a id="3811" href="CG.Syntax.html#3811" class="Bound">θ</a> <a id="3813" class="Symbol">:</a> <a id="3815" href="CG.Syntax.html#Env" class="Datatype">Env</a> <a id="3819" href="CG.Syntax.html#3781" class="Bound">Γ</a><a id="3820" class="Symbol">)</a> <a id="3822" class="Symbol">→</a> <a id="3824" href="CG.Syntax.html#Value" class="Datatype">Value</a> <a id="3830" class="Symbol">(</a><a id="3831" href="CG.Types.html#Ty.LIO" class="InductiveConstructor">LIO</a> <a id="3835" href="CG.Syntax.html#3783" class="Bound">τ</a><a id="3836" class="Symbol">)</a>

    <a id="Value.inl" href="CG.Syntax.html#Value.inl" class="InductiveConstructor">inl</a> <a id="3847" class="Symbol">:</a> <a id="3849" class="Symbol">∀</a> <a id="3851" class="Symbol">{</a><a id="3852" href="CG.Syntax.html#3852" class="Bound">τ₁</a> <a id="3855" href="CG.Syntax.html#3855" class="Bound">τ₂</a><a id="3857" class="Symbol">}</a> <a id="3859" class="Symbol">→</a> <a id="3861" href="CG.Syntax.html#Value" class="Datatype">Value</a> <a id="3867" href="CG.Syntax.html#3852" class="Bound">τ₁</a> <a id="3870" class="Symbol">→</a> <a id="3872" href="CG.Syntax.html#Value" class="Datatype">Value</a> <a id="3878" class="Symbol">(</a><a id="3879" href="CG.Syntax.html#3852" class="Bound">τ₁</a> <a id="3882" href="CG.Types.html#Ty._%2B_" class="InductiveConstructor Operator">+</a> <a id="3884" href="CG.Syntax.html#3855" class="Bound">τ₂</a><a id="3886" class="Symbol">)</a>

    <a id="Value.inr" href="CG.Syntax.html#Value.inr" class="InductiveConstructor">inr</a> <a id="3897" class="Symbol">:</a> <a id="3899" class="Symbol">∀</a> <a id="3901" class="Symbol">{</a><a id="3902" href="CG.Syntax.html#3902" class="Bound">τ₁</a> <a id="3905" href="CG.Syntax.html#3905" class="Bound">τ₂</a><a id="3907" class="Symbol">}</a> <a id="3909" class="Symbol">→</a> <a id="3911" href="CG.Syntax.html#Value" class="Datatype">Value</a> <a id="3917" href="CG.Syntax.html#3905" class="Bound">τ₂</a> <a id="3920" class="Symbol">→</a> <a id="3922" href="CG.Syntax.html#Value" class="Datatype">Value</a> <a id="3928" class="Symbol">(</a><a id="3929" href="CG.Syntax.html#3902" class="Bound">τ₁</a> <a id="3932" href="CG.Types.html#Ty._%2B_" class="InductiveConstructor Operator">+</a> <a id="3934" href="CG.Syntax.html#3905" class="Bound">τ₂</a><a id="3936" class="Symbol">)</a>

    <a id="Value.⟨_,_⟩" href="CG.Syntax.html#Value.%E2%9F%A8_%2C_%E2%9F%A9" class="InductiveConstructor Operator">⟨_,_⟩</a> <a id="3949" class="Symbol">:</a> <a id="3951" class="Symbol">∀</a> <a id="3953" class="Symbol">{</a><a id="3954" href="CG.Syntax.html#3954" class="Bound">τ₁</a> <a id="3957" href="CG.Syntax.html#3957" class="Bound">τ₂</a><a id="3959" class="Symbol">}</a> <a id="3961" class="Symbol">→</a> <a id="3963" href="CG.Syntax.html#Value" class="Datatype">Value</a> <a id="3969" href="CG.Syntax.html#3954" class="Bound">τ₁</a> <a id="3972" class="Symbol">→</a> <a id="3974" href="CG.Syntax.html#Value" class="Datatype">Value</a> <a id="3980" href="CG.Syntax.html#3957" class="Bound">τ₂</a> <a id="3983" class="Symbol">→</a> <a id="3985" href="CG.Syntax.html#Value" class="Datatype">Value</a> <a id="3991" class="Symbol">(</a><a id="3992" href="CG.Syntax.html#3954" class="Bound">τ₁</a> <a id="3995" href="CG.Types.html#Ty._%C3%97_" class="InductiveConstructor Operator">×</a> <a id="3997" href="CG.Syntax.html#3957" class="Bound">τ₂</a><a id="3999" class="Symbol">)</a>

    <a id="4006" class="Comment">-- Labeled value</a>
    <a id="Value.Labeled" href="CG.Syntax.html#Value.Labeled" class="InductiveConstructor">Labeled</a> <a id="4035" class="Symbol">:</a> <a id="4037" class="Symbol">∀</a> <a id="4039" class="Symbol">{</a><a id="4040" href="CG.Syntax.html#4040" class="Bound">τ</a><a id="4041" class="Symbol">}</a> <a id="4043" class="Symbol">(</a><a id="4044" href="CG.Syntax.html#4044" class="Bound">ℓ</a> <a id="4046" class="Symbol">:</a> <a id="4048" href="Lattice.Base.html#Label" class="Field">Label</a><a id="4053" class="Symbol">)</a> <a id="4055" class="Symbol">→</a> <a id="4057" href="CG.Syntax.html#Value" class="Datatype">Value</a> <a id="4063" href="CG.Syntax.html#4040" class="Bound">τ</a> <a id="4065" class="Symbol">→</a> <a id="4067" href="CG.Syntax.html#Value" class="Datatype">Value</a> <a id="4073" class="Symbol">(</a><a id="4074" href="CG.Types.html#Ty.Labeled" class="InductiveConstructor">Labeled</a> <a id="4082" href="CG.Syntax.html#4040" class="Bound">τ</a><a id="4083" class="Symbol">)</a>

    <a id="4090" class="Comment">-- Labeled reference</a>
    <a id="Value.Ref" href="CG.Syntax.html#Value.Ref" class="InductiveConstructor">Ref</a> <a id="4119" class="Symbol">:</a> <a id="4121" class="Symbol">∀</a> <a id="4123" class="Symbol">{</a><a id="4124" href="CG.Syntax.html#4124" class="Bound">τ</a><a id="4125" class="Symbol">}</a> <a id="4127" class="Symbol">(</a><a id="4128" href="CG.Syntax.html#4128" class="Bound">ℓ</a> <a id="4130" class="Symbol">:</a> <a id="4132" href="Lattice.Base.html#Label" class="Field">Label</a><a id="4137" class="Symbol">)</a> <a id="4139" class="Symbol">(</a><a id="4140" href="CG.Syntax.html#4140" class="Bound">n</a> <a id="4142" class="Symbol">:</a> <a id="4144" href="Agda.Builtin.Nat.html#%E2%84%95" class="Datatype">ℕ</a><a id="4145" class="Symbol">)</a> <a id="4147" class="Symbol">→</a> <a id="4149" href="CG.Syntax.html#Value" class="Datatype">Value</a> <a id="4155" class="Symbol">(</a><a id="4156" href="CG.Types.html#Ty.Ref" class="InductiveConstructor">Ref</a> <a id="4160" href="CG.Syntax.html#4124" class="Bound">τ</a><a id="4161" class="Symbol">)</a>

    <a id="4168" class="Comment">-- First class labels</a>
    <a id="Value.⌞_⌟" href="CG.Syntax.html#Value.%E2%8C%9E_%E2%8C%9F" class="InductiveConstructor Operator">⌞_⌟</a> <a id="4198" class="Symbol">:</a> <a id="4200" class="Symbol">(</a><a id="4201" href="CG.Syntax.html#4201" class="Bound">ℓ</a> <a id="4203" class="Symbol">:</a> <a id="4205" href="Lattice.Base.html#Label" class="Field">Label</a><a id="4210" class="Symbol">)</a> <a id="4212" class="Symbol">→</a> <a id="4214" href="CG.Syntax.html#Value" class="Datatype">Value</a> <a id="4220" href="CG.Types.html#Ty.%F0%9D%93%9B" class="InductiveConstructor">𝓛</a>


<a id="4224" class="Keyword">infixr</a> <a id="4231" class="Number">5</a> <a id="4233" href="CG.Syntax.html#Env._%E2%88%B7_" class="InductiveConstructor Operator">_∷_</a>

<a id="4238" class="Comment">-- Shorthands for Booleans</a>

<a id="true" href="CG.Syntax.html#true" class="Function">true</a> <a id="4271" class="Symbol">:</a> <a id="4273" href="CG.Syntax.html#Value" class="Datatype">Value</a> <a id="4279" href="CG.Types.html#Bool" class="Function">Bool</a>
<a id="4284" href="CG.Syntax.html#true" class="Function">true</a> <a id="4289" class="Symbol">=</a> <a id="4291" href="CG.Syntax.html#Value.inl" class="InductiveConstructor">inl</a> <a id="4295" href="CG.Syntax.html#Value.%EF%BC%88%EF%BC%89" class="InductiveConstructor">（）</a>

<a id="false" href="CG.Syntax.html#false" class="Function">false</a> <a id="4305" class="Symbol">:</a> <a id="4307" href="CG.Syntax.html#Value" class="Datatype">Value</a> <a id="4313" href="CG.Types.html#Bool" class="Function">Bool</a>
<a id="4318" href="CG.Syntax.html#false" class="Function">false</a> <a id="4324" class="Symbol">=</a> <a id="4326" href="CG.Syntax.html#Value.inr" class="InductiveConstructor">inr</a> <a id="4330" href="CG.Syntax.html#Value.%EF%BC%88%EF%BC%89" class="InductiveConstructor">（）</a>

<a id="if_then_else_" href="CG.Syntax.html#if_then_else_" class="Function Operator">if_then_else_</a> <a id="4348" class="Symbol">:</a> <a id="4350" class="Symbol">∀</a> <a id="4352" class="Symbol">{</a><a id="4353" href="CG.Syntax.html#4353" class="Bound">Γ</a> <a id="4355" href="CG.Syntax.html#4355" class="Bound">τ</a><a id="4356" class="Symbol">}</a> <a id="4358" class="Symbol">→</a> <a id="4360" href="CG.Syntax.html#Expr" class="Datatype">Expr</a> <a id="4365" href="CG.Syntax.html#4353" class="Bound">Γ</a> <a id="4367" href="CG.Types.html#Bool" class="Function">Bool</a> <a id="4372" class="Symbol">→</a> <a id="4374" href="CG.Syntax.html#Expr" class="Datatype">Expr</a> <a id="4379" href="CG.Syntax.html#4353" class="Bound">Γ</a> <a id="4381" href="CG.Syntax.html#4355" class="Bound">τ</a> <a id="4383" class="Symbol">→</a> <a id="4385" href="CG.Syntax.html#Expr" class="Datatype">Expr</a> <a id="4390" href="CG.Syntax.html#4353" class="Bound">Γ</a> <a id="4392" href="CG.Syntax.html#4355" class="Bound">τ</a> <a id="4394" class="Symbol">→</a> <a id="4396" href="CG.Syntax.html#Expr" class="Datatype">Expr</a> <a id="4401" href="CG.Syntax.html#4353" class="Bound">Γ</a> <a id="4403" href="CG.Syntax.html#4355" class="Bound">τ</a>
<a id="4405" href="CG.Syntax.html#if_then_else_" class="Function Operator">if_then_else_</a> <a id="4419" href="CG.Syntax.html#4419" class="Bound">c</a> <a id="4421" href="CG.Syntax.html#4421" class="Bound">t</a> <a id="4423" href="CG.Syntax.html#4423" class="Bound">e</a> <a id="4425" class="Symbol">=</a> <a id="4427" href="CG.Syntax.html#Expr.case" class="InductiveConstructor">case</a> <a id="4432" href="CG.Syntax.html#4419" class="Bound">c</a> <a id="4434" class="Symbol">(</a><a id="4435" href="CG.Syntax.html#Expr.wken" class="InductiveConstructor">wken</a> <a id="4440" href="CG.Syntax.html#4421" class="Bound">t</a> <a id="4442" class="Symbol">(</a><a id="4443" href="Generic.Context.Base.html#drop" class="InductiveConstructor">drop</a> <a id="4448" href="Generic.Context.Base.html#refl-%E2%8A%86" class="Function">refl-⊆</a><a id="4454" class="Symbol">))</a> <a id="4457" class="Symbol">(</a><a id="4458" href="CG.Syntax.html#Expr.wken" class="InductiveConstructor">wken</a> <a id="4463" href="CG.Syntax.html#4423" class="Bound">e</a> <a id="4465" class="Symbol">(</a><a id="4466" href="Generic.Context.Base.html#drop" class="InductiveConstructor">drop</a> <a id="4471" href="Generic.Context.Base.html#refl-%E2%8A%86" class="Function">refl-⊆</a><a id="4477" class="Symbol">))</a>

<a id="4481" class="Comment">--------------------------------------------------------------------------------</a>
<a id="4562" class="Comment">-- Configurations</a>

<a id="4581" class="Comment">-- Generic store.</a>
<a id="4599" class="Keyword">open</a> <a id="4604" class="Keyword">import</a> <a id="4611" href="Generic.Store.html" class="Module">Generic.Store</a> <a id="4625" href="CG.Types.html#Ty" class="Datatype">Ty</a> <a id="4628" href="CG.Syntax.html#Value" class="Datatype">Value</a> <a id="4634" class="Keyword">public</a>

<a id="4642" class="Comment">-- Generic configuration container.</a>
<a id="4678" class="Keyword">record</a> <a id="Conf" href="CG.Syntax.html#Conf" class="Record">Conf</a> <a id="4690" class="Symbol">(</a><a id="4691" href="CG.Syntax.html#4691" class="Bound">A</a> <a id="4693" class="Symbol">:</a> <a id="4695" class="PrimitiveType">Set</a><a id="4698" class="Symbol">)</a> <a id="4700" class="Symbol">:</a> <a id="4702" class="PrimitiveType">Set</a> <a id="4706" class="Keyword">where</a>
  <a id="4714" class="Keyword">constructor</a> <a id="Conf.⟨_,_,_⟩" href="CG.Syntax.html#Conf.%E2%9F%A8_%2C_%2C_%E2%9F%A9" class="InductiveConstructor Operator">⟨_,_,_⟩</a>
  <a id="4736" class="Keyword">field</a> <a id="Conf.store" href="CG.Syntax.html#Conf.store" class="Field">store</a> <a id="4748" class="Symbol">:</a> <a id="4750" href="Generic.Store.Base.html#Store" class="Function">Store</a>
        <a id="Conf.pc" href="CG.Syntax.html#Conf.pc" class="Field">pc</a> <a id="4767" class="Symbol">:</a> <a id="4769" href="Lattice.Base.html#Label" class="Field">Label</a>
        <a id="Conf.term" href="CG.Syntax.html#Conf.term" class="Field">term</a> <a id="4788" class="Symbol">:</a> <a id="4790" href="CG.Syntax.html#4691" class="Bound">A</a>

<a id="4793" class="Comment">-- Initial Configuration (Expr)</a>
<a id="EConf" href="CG.Syntax.html#EConf" class="Function">EConf</a> <a id="4831" class="Symbol">:</a> <a id="4833" href="Generic.Context.Base.html#Ctx" class="Function">Ctx</a> <a id="4837" class="Symbol">→</a> <a id="4839" href="CG.Types.html#Ty" class="Datatype">Ty</a> <a id="4842" class="Symbol">→</a> <a id="4844" class="PrimitiveType">Set</a>
<a id="4848" href="CG.Syntax.html#EConf" class="Function">EConf</a> <a id="4854" href="CG.Syntax.html#4854" class="Bound">Γ</a> <a id="4856" href="CG.Syntax.html#4856" class="Bound">τ</a> <a id="4858" class="Symbol">=</a> <a id="4860" href="CG.Syntax.html#Conf" class="Record">Conf</a> <a id="4865" class="Symbol">(</a><a id="4866" href="CG.Syntax.html#Expr" class="Datatype">Expr</a> <a id="4871" href="CG.Syntax.html#4854" class="Bound">Γ</a> <a id="4873" href="CG.Syntax.html#4856" class="Bound">τ</a><a id="4874" class="Symbol">)</a>

<a id="4877" class="Comment">-- Initial Configuration (Thunk)</a>
<a id="TConf" href="CG.Syntax.html#TConf" class="Function">TConf</a> <a id="4916" class="Symbol">:</a> <a id="4918" href="Generic.Context.Base.html#Ctx" class="Function">Ctx</a> <a id="4922" class="Symbol">→</a> <a id="4924" href="CG.Types.html#Ty" class="Datatype">Ty</a> <a id="4927" class="Symbol">→</a> <a id="4929" class="PrimitiveType">Set</a>
<a id="4933" href="CG.Syntax.html#TConf" class="Function">TConf</a> <a id="4939" href="CG.Syntax.html#4939" class="Bound">Γ</a> <a id="4941" href="CG.Syntax.html#4941" class="Bound">τ</a> <a id="4943" class="Symbol">=</a> <a id="4945" href="CG.Syntax.html#Conf" class="Record">Conf</a> <a id="4950" class="Symbol">(</a><a id="4951" href="CG.Syntax.html#Thunk" class="Datatype">Thunk</a> <a id="4957" href="CG.Syntax.html#4939" class="Bound">Γ</a> <a id="4959" href="CG.Syntax.html#4941" class="Bound">τ</a><a id="4960" class="Symbol">)</a>

<a id="4963" class="Comment">-- Final configuration (Value)</a>
<a id="FConf" href="CG.Syntax.html#FConf" class="Function">FConf</a> <a id="5000" class="Symbol">:</a> <a id="5002" href="CG.Types.html#Ty" class="Datatype">Ty</a> <a id="5005" class="Symbol">→</a> <a id="5007" class="PrimitiveType">Set</a>
<a id="5011" href="CG.Syntax.html#FConf" class="Function">FConf</a> <a id="5017" href="CG.Syntax.html#5017" class="Bound">τ</a> <a id="5019" class="Symbol">=</a> <a id="5021" href="CG.Syntax.html#Conf" class="Record">Conf</a> <a id="5026" class="Symbol">(</a><a id="5027" href="CG.Syntax.html#Value" class="Datatype">Value</a> <a id="5033" href="CG.Syntax.html#5017" class="Bound">τ</a><a id="5034" class="Symbol">)</a>

<a id="5037" class="Comment">-- Projections</a>

<a id="expr" href="CG.Syntax.html#expr" class="Function">expr</a> <a id="5058" class="Symbol">:</a> <a id="5060" class="Symbol">∀</a> <a id="5062" class="Symbol">{</a><a id="5063" href="CG.Syntax.html#5063" class="Bound">Γ</a> <a id="5065" href="CG.Syntax.html#5065" class="Bound">τ</a><a id="5066" class="Symbol">}</a> <a id="5068" class="Symbol">→</a> <a id="5070" href="CG.Syntax.html#EConf" class="Function">EConf</a> <a id="5076" href="CG.Syntax.html#5063" class="Bound">Γ</a> <a id="5078" href="CG.Syntax.html#5065" class="Bound">τ</a> <a id="5080" class="Symbol">→</a> <a id="5082" href="CG.Syntax.html#Expr" class="Datatype">Expr</a> <a id="5087" href="CG.Syntax.html#5063" class="Bound">Γ</a> <a id="5089" href="CG.Syntax.html#5065" class="Bound">τ</a>
<a id="5091" href="CG.Syntax.html#expr" class="Function">expr</a> <a id="5096" class="Symbol">=</a> <a id="5098" href="CG.Syntax.html#Conf.term" class="Field">Conf.term</a>

<a id="thunk" href="CG.Syntax.html#thunk" class="Function">thunk</a> <a id="5115" class="Symbol">:</a>  <a id="5118" class="Symbol">∀</a> <a id="5120" class="Symbol">{</a><a id="5121" href="CG.Syntax.html#5121" class="Bound">Γ</a> <a id="5123" href="CG.Syntax.html#5123" class="Bound">τ</a><a id="5124" class="Symbol">}</a> <a id="5126" class="Symbol">→</a> <a id="5128" href="CG.Syntax.html#TConf" class="Function">TConf</a> <a id="5134" href="CG.Syntax.html#5121" class="Bound">Γ</a> <a id="5136" href="CG.Syntax.html#5123" class="Bound">τ</a> <a id="5138" class="Symbol">→</a> <a id="5140" href="CG.Syntax.html#Thunk" class="Datatype">Thunk</a> <a id="5146" href="CG.Syntax.html#5121" class="Bound">Γ</a> <a id="5148" href="CG.Syntax.html#5123" class="Bound">τ</a>
<a id="5150" href="CG.Syntax.html#thunk" class="Function">thunk</a> <a id="5156" class="Symbol">=</a> <a id="5158" href="CG.Syntax.html#Conf.term" class="Field">Conf.term</a>

<a id="val" href="CG.Syntax.html#val" class="Function">val</a> <a id="5173" class="Symbol">:</a> <a id="5175" class="Symbol">∀</a> <a id="5177" class="Symbol">{</a><a id="5178" href="CG.Syntax.html#5178" class="Bound">τ</a><a id="5179" class="Symbol">}</a> <a id="5181" class="Symbol">→</a> <a id="5183" href="CG.Syntax.html#FConf" class="Function">FConf</a> <a id="5189" href="CG.Syntax.html#5178" class="Bound">τ</a> <a id="5191" class="Symbol">→</a> <a id="5193" href="CG.Syntax.html#Value" class="Datatype">Value</a> <a id="5199" href="CG.Syntax.html#5178" class="Bound">τ</a>
<a id="5201" href="CG.Syntax.html#val" class="Function">val</a> <a id="5205" class="Symbol">=</a> <a id="5207" href="CG.Syntax.html#Conf.term" class="Field">Conf.term</a>

<a id="5218" class="Comment">--------------------------------------------------------------------------------</a>
<a id="5299" class="Comment">-- Weakening once and twice.</a>

<a id="_↑¹" href="CG.Syntax.html#_%E2%86%91%C2%B9" class="Function Operator">_↑¹</a> <a id="5333" class="Symbol">:</a> <a id="5335" class="Symbol">∀</a> <a id="5337" class="Symbol">{</a><a id="5338" href="CG.Syntax.html#5338" class="Bound">Γ</a> <a id="5340" href="CG.Syntax.html#5340" class="Bound">τ</a> <a id="5342" href="CG.Syntax.html#5342" class="Bound">τ₁</a><a id="5344" class="Symbol">}</a> <a id="5346" class="Symbol">→</a> <a id="5348" href="CG.Syntax.html#Expr" class="Datatype">Expr</a> <a id="5353" href="CG.Syntax.html#5338" class="Bound">Γ</a> <a id="5355" href="CG.Syntax.html#5340" class="Bound">τ</a> <a id="5357" class="Symbol">→</a> <a id="5359" href="CG.Syntax.html#Expr" class="Datatype">Expr</a> <a id="5364" class="Symbol">(</a><a id="5365" href="CG.Syntax.html#5342" class="Bound">τ₁</a> <a id="5368" href="Agda.Builtin.List.html#_%E2%88%B7_" class="InductiveConstructor Operator">∷</a> <a id="5370" href="CG.Syntax.html#5338" class="Bound">Γ</a><a id="5371" class="Symbol">)</a> <a id="5373" href="CG.Syntax.html#5340" class="Bound">τ</a>
<a id="5375" href="CG.Syntax.html#5375" class="Bound">e</a> <a id="5377" href="CG.Syntax.html#_%E2%86%91%C2%B9" class="Function Operator">↑¹</a> <a id="5380" class="Symbol">=</a> <a id="5382" href="CG.Syntax.html#Expr.wken" class="InductiveConstructor">wken</a> <a id="5387" href="CG.Syntax.html#5375" class="Bound">e</a> <a id="5389" class="Symbol">(</a><a id="5390" href="Generic.Context.Base.html#drop" class="InductiveConstructor">drop</a> <a id="5395" href="Generic.Context.Base.html#refl-%E2%8A%86" class="Function">refl-⊆</a><a id="5401" class="Symbol">)</a>

<a id="_↑²" href="CG.Syntax.html#_%E2%86%91%C2%B2" class="Function Operator">_↑²</a> <a id="5408" class="Symbol">:</a> <a id="5410" class="Symbol">∀</a> <a id="5412" class="Symbol">{</a><a id="5413" href="CG.Syntax.html#5413" class="Bound">Γ</a> <a id="5415" href="CG.Syntax.html#5415" class="Bound">τ</a> <a id="5417" href="CG.Syntax.html#5417" class="Bound">τ₁</a> <a id="5420" href="CG.Syntax.html#5420" class="Bound">τ₂</a><a id="5422" class="Symbol">}</a> <a id="5424" class="Symbol">→</a> <a id="5426" href="CG.Syntax.html#Expr" class="Datatype">Expr</a> <a id="5431" href="CG.Syntax.html#5413" class="Bound">Γ</a> <a id="5433" href="CG.Syntax.html#5415" class="Bound">τ</a> <a id="5435" class="Symbol">→</a> <a id="5437" href="CG.Syntax.html#Expr" class="Datatype">Expr</a> <a id="5442" class="Symbol">(</a><a id="5443" href="CG.Syntax.html#5420" class="Bound">τ₂</a> <a id="5446" href="Agda.Builtin.List.html#_%E2%88%B7_" class="InductiveConstructor Operator">∷</a> <a id="5448" href="CG.Syntax.html#5417" class="Bound">τ₁</a> <a id="5451" href="Agda.Builtin.List.html#_%E2%88%B7_" class="InductiveConstructor Operator">∷</a> <a id="5453" href="CG.Syntax.html#5413" class="Bound">Γ</a><a id="5454" class="Symbol">)</a> <a id="5456" href="CG.Syntax.html#5415" class="Bound">τ</a>
<a id="5458" href="CG.Syntax.html#5458" class="Bound">e</a> <a id="5460" href="CG.Syntax.html#_%E2%86%91%C2%B2" class="Function Operator">↑²</a> <a id="5463" class="Symbol">=</a> <a id="5465" href="CG.Syntax.html#Expr.wken" class="InductiveConstructor">wken</a> <a id="5470" href="CG.Syntax.html#5458" class="Bound">e</a> <a id="5472" class="Symbol">(</a><a id="5473" href="Generic.Context.Base.html#drop" class="InductiveConstructor">drop</a> <a id="5478" class="Symbol">(</a><a id="5479" href="Generic.Context.Base.html#drop" class="InductiveConstructor">drop</a> <a id="5484" href="Generic.Context.Base.html#refl-%E2%8A%86" class="Function">refl-⊆</a><a id="5490" class="Symbol">))</a>

<a id="5494" class="Comment">--------------------------------------------------------------------------------</a>
<a id="5575" class="Comment">-- Environment operations and proofs</a>

<a id="5613" class="Comment">-- Merge environments.</a>
<a id="_++ᴱ_" href="CG.Syntax.html#_%2B%2B%E1%B4%B1_" class="Function Operator">_++ᴱ_</a> <a id="5642" class="Symbol">:</a> <a id="5644" class="Symbol">∀</a> <a id="5646" class="Symbol">{</a><a id="5647" href="CG.Syntax.html#5647" class="Bound">Γ₁</a> <a id="5650" href="CG.Syntax.html#5650" class="Bound">Γ₂</a><a id="5652" class="Symbol">}</a> <a id="5654" class="Symbol">→</a> <a id="5656" href="CG.Syntax.html#Env" class="Datatype">Env</a> <a id="5660" href="CG.Syntax.html#5647" class="Bound">Γ₁</a> <a id="5663" class="Symbol">→</a> <a id="5665" href="CG.Syntax.html#Env" class="Datatype">Env</a> <a id="5669" href="CG.Syntax.html#5650" class="Bound">Γ₂</a> <a id="5672" class="Symbol">→</a> <a id="5674" href="CG.Syntax.html#Env" class="Datatype">Env</a> <a id="5678" class="Symbol">(</a><a id="5679" href="CG.Syntax.html#5647" class="Bound">Γ₁</a> <a id="5682" href="Data.List.Base.html#_%2B%2B_" class="Function Operator">++</a> <a id="5685" href="CG.Syntax.html#5650" class="Bound">Γ₂</a><a id="5687" class="Symbol">)</a>
<a id="5689" href="CG.Syntax.html#Env.%5B%5D" class="InductiveConstructor">[]</a> <a id="5692" href="CG.Syntax.html#_%2B%2B%E1%B4%B1_" class="Function Operator">++ᴱ</a> <a id="5696" href="CG.Syntax.html#5696" class="Bound">θ₂</a> <a id="5699" class="Symbol">=</a> <a id="5701" href="CG.Syntax.html#5696" class="Bound">θ₂</a>
<a id="5704" class="Symbol">(</a><a id="5705" href="CG.Syntax.html#5705" class="Bound">v</a> <a id="5707" href="CG.Syntax.html#Env._%E2%88%B7_" class="InductiveConstructor Operator">∷</a> <a id="5709" href="CG.Syntax.html#5709" class="Bound">θ₁</a><a id="5711" class="Symbol">)</a> <a id="5713" href="CG.Syntax.html#_%2B%2B%E1%B4%B1_" class="Function Operator">++ᴱ</a> <a id="5717" href="CG.Syntax.html#5717" class="Bound">θ₂</a> <a id="5720" class="Symbol">=</a> <a id="5722" href="CG.Syntax.html#5705" class="Bound">v</a> <a id="5724" href="CG.Syntax.html#Env._%E2%88%B7_" class="InductiveConstructor Operator">∷</a> <a id="5726" class="Symbol">(</a><a id="5727" href="CG.Syntax.html#5709" class="Bound">θ₁</a> <a id="5730" href="CG.Syntax.html#_%2B%2B%E1%B4%B1_" class="Function Operator">++ᴱ</a> <a id="5734" href="CG.Syntax.html#5717" class="Bound">θ₂</a><a id="5736" class="Symbol">)</a>

<a id="5739" class="Comment">-- Lookup a variable in the environment.</a>
<a id="_!!_" href="CG.Syntax.html#_%21%21_" class="Function Operator">_!!_</a> <a id="5785" class="Symbol">:</a> <a id="5787" class="Symbol">∀</a> <a id="5789" class="Symbol">{</a><a id="5790" href="CG.Syntax.html#5790" class="Bound">τ</a> <a id="5792" href="CG.Syntax.html#5792" class="Bound">Γ</a><a id="5793" class="Symbol">}</a> <a id="5795" class="Symbol">→</a> <a id="5797" href="CG.Syntax.html#Env" class="Datatype">Env</a> <a id="5801" href="CG.Syntax.html#5792" class="Bound">Γ</a> <a id="5803" class="Symbol">→</a> <a id="5805" href="CG.Syntax.html#5790" class="Bound">τ</a> <a id="5807" href="Data.List.Any.Membership.html#_%E2%88%88_" class="Function Operator">∈</a> <a id="5809" href="CG.Syntax.html#5792" class="Bound">Γ</a> <a id="5811" class="Symbol">→</a> <a id="5813" href="CG.Syntax.html#Value" class="Datatype">Value</a> <a id="5819" href="CG.Syntax.html#5790" class="Bound">τ</a>
<a id="5821" class="Symbol">(</a><a id="5822" href="CG.Syntax.html#5822" class="Bound">v</a> <a id="5824" href="CG.Syntax.html#Env._%E2%88%B7_" class="InductiveConstructor Operator">∷</a> <a id="5826" href="CG.Syntax.html#5826" class="Bound">θ</a><a id="5827" class="Symbol">)</a> <a id="5829" href="CG.Syntax.html#_%21%21_" class="Function Operator">!!</a> <a id="5832" href="Generic.Context.Base.html#here" class="InductiveConstructor">here</a> <a id="5837" class="Symbol">=</a> <a id="5839" href="CG.Syntax.html#5822" class="Bound">v</a>
<a id="5841" class="Symbol">(</a><a id="5842" href="CG.Syntax.html#5842" class="Bound">v</a> <a id="5844" href="CG.Syntax.html#Env._%E2%88%B7_" class="InductiveConstructor Operator">∷</a> <a id="5846" href="CG.Syntax.html#5846" class="Bound">θ</a><a id="5847" class="Symbol">)</a> <a id="5849" href="CG.Syntax.html#_%21%21_" class="Function Operator">!!</a> <a id="5852" class="Symbol">(</a><a id="5853" href="Generic.Context.Base.html#there" class="InductiveConstructor">there</a> <a id="5859" href="CG.Syntax.html#5859" class="Bound">τ∈Γ</a><a id="5862" class="Symbol">)</a> <a id="5864" class="Symbol">=</a> <a id="5866" href="CG.Syntax.html#5846" class="Bound">θ</a> <a id="5868" href="CG.Syntax.html#_%21%21_" class="Function Operator">!!</a> <a id="5871" href="CG.Syntax.html#5859" class="Bound">τ∈Γ</a>

<a id="5876" class="Comment">-- Shrink enviroment.</a>
<a id="slice" href="CG.Syntax.html#slice" class="Function">slice</a> <a id="5904" class="Symbol">:</a> <a id="5906" class="Symbol">∀</a> <a id="5908" class="Symbol">{</a><a id="5909" href="CG.Syntax.html#5909" class="Bound">Γ₁</a> <a id="5912" href="CG.Syntax.html#5912" class="Bound">Γ₂</a><a id="5914" class="Symbol">}</a> <a id="5916" class="Symbol">→</a> <a id="5918" href="CG.Syntax.html#Env" class="Datatype">Env</a> <a id="5922" href="CG.Syntax.html#5912" class="Bound">Γ₂</a> <a id="5925" class="Symbol">→</a> <a id="5927" href="CG.Syntax.html#5909" class="Bound">Γ₁</a> <a id="5930" href="Generic.Context.Base.html#_%E2%8A%86_" class="Datatype Operator">⊆</a> <a id="5932" href="CG.Syntax.html#5912" class="Bound">Γ₂</a> <a id="5935" class="Symbol">→</a> <a id="5937" href="CG.Syntax.html#Env" class="Datatype">Env</a> <a id="5941" href="CG.Syntax.html#5909" class="Bound">Γ₁</a>
<a id="5944" href="CG.Syntax.html#slice" class="Function">slice</a> <a id="5950" href="CG.Syntax.html#Env.%5B%5D" class="InductiveConstructor">[]</a> <a id="5953" href="Generic.Context.Base.html#base" class="InductiveConstructor">base</a> <a id="5958" class="Symbol">=</a> <a id="5960" href="CG.Syntax.html#Env.%5B%5D" class="InductiveConstructor">[]</a>
<a id="5963" href="CG.Syntax.html#slice" class="Function">slice</a> <a id="5969" class="Symbol">(</a><a id="5970" href="CG.Syntax.html#5970" class="Bound">v</a> <a id="5972" href="CG.Syntax.html#Env._%E2%88%B7_" class="InductiveConstructor Operator">∷</a> <a id="5974" href="CG.Syntax.html#5974" class="Bound">θ</a><a id="5975" class="Symbol">)</a> <a id="5977" class="Symbol">(</a><a id="5978" href="Generic.Context.Base.html#cons" class="InductiveConstructor">cons</a> <a id="5983" href="CG.Syntax.html#5983" class="Bound">p</a><a id="5984" class="Symbol">)</a> <a id="5986" class="Symbol">=</a> <a id="5988" href="CG.Syntax.html#5970" class="Bound">v</a> <a id="5990" href="CG.Syntax.html#Env._%E2%88%B7_" class="InductiveConstructor Operator">∷</a> <a id="5992" href="CG.Syntax.html#slice" class="Function">slice</a> <a id="5998" href="CG.Syntax.html#5974" class="Bound">θ</a> <a id="6000" href="CG.Syntax.html#5983" class="Bound">p</a>
<a id="6002" href="CG.Syntax.html#slice" class="Function">slice</a> <a id="6008" class="Symbol">(</a><a id="6009" href="CG.Syntax.html#6009" class="Bound">v</a> <a id="6011" href="CG.Syntax.html#Env._%E2%88%B7_" class="InductiveConstructor Operator">∷</a> <a id="6013" href="CG.Syntax.html#6013" class="Bound">θ</a><a id="6014" class="Symbol">)</a> <a id="6016" class="Symbol">(</a><a id="6017" href="Generic.Context.Base.html#drop" class="InductiveConstructor">drop</a> <a id="6022" href="CG.Syntax.html#6022" class="Bound">p</a><a id="6023" class="Symbol">)</a> <a id="6025" class="Symbol">=</a> <a id="6027" href="CG.Syntax.html#slice" class="Function">slice</a> <a id="6033" href="CG.Syntax.html#6013" class="Bound">θ</a> <a id="6035" href="CG.Syntax.html#6022" class="Bound">p</a>

<a id="6038" class="Comment">--------------------------------------------------------------------------------</a>
<a id="6119" class="Comment">-- Basic proofs and rewriting.</a>

<a id="6151" class="Keyword">open</a> <a id="6156" class="Keyword">import</a> <a id="6163" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a>

<a id="slice-refl-⊆-≡" href="CG.Syntax.html#slice-refl-%E2%8A%86-%E2%89%A1" class="Function">slice-refl-⊆-≡</a> <a id="6217" class="Symbol">:</a> <a id="6219" class="Symbol">∀</a> <a id="6221" class="Symbol">{</a><a id="6222" href="CG.Syntax.html#6222" class="Bound">Γ</a><a id="6223" class="Symbol">}</a> <a id="6225" class="Symbol">{</a><a id="6226" href="CG.Syntax.html#6226" class="Bound">θ</a> <a id="6228" class="Symbol">:</a> <a id="6230" href="CG.Syntax.html#Env" class="Datatype">Env</a> <a id="6234" href="CG.Syntax.html#6222" class="Bound">Γ</a><a id="6235" class="Symbol">}</a> <a id="6237" class="Symbol">→</a> <a id="6239" href="CG.Syntax.html#slice" class="Function">slice</a> <a id="6245" href="CG.Syntax.html#6226" class="Bound">θ</a> <a id="6247" href="Generic.Context.Base.html#refl-%E2%8A%86" class="Function">refl-⊆</a> <a id="6254" href="Agda.Builtin.Equality.html#_%E2%89%A1_" class="Datatype Operator">≡</a> <a id="6256" href="CG.Syntax.html#6226" class="Bound">θ</a>
<a id="6258" href="CG.Syntax.html#slice-refl-%E2%8A%86-%E2%89%A1" class="Function">slice-refl-⊆-≡</a> <a id="6273" class="Symbol">{</a><a id="6274" class="Argument">θ</a> <a id="6276" class="Symbol">=</a> <a id="6278" href="CG.Syntax.html#Env.%5B%5D" class="InductiveConstructor">[]</a><a id="6280" class="Symbol">}</a> <a id="6282" class="Symbol">=</a> <a id="6284" href="Agda.Builtin.Equality.html#_%E2%89%A1_.refl" class="InductiveConstructor">refl</a>
<a id="6289" href="CG.Syntax.html#slice-refl-%E2%8A%86-%E2%89%A1" class="Function">slice-refl-⊆-≡</a> <a id="6304" class="Symbol">{</a><a id="6305" class="Argument">θ</a> <a id="6307" class="Symbol">=</a> <a id="6309" href="CG.Syntax.html#6309" class="Bound">v</a> <a id="6311" href="CG.Syntax.html#Env._%E2%88%B7_" class="InductiveConstructor Operator">∷</a> <a id="6313" href="CG.Syntax.html#6313" class="Bound">θ</a><a id="6314" class="Symbol">}</a> <a id="6316" class="Keyword">rewrite</a> <a id="6324" href="CG.Syntax.html#slice-refl-%E2%8A%86-%E2%89%A1" class="Function">slice-refl-⊆-≡</a> <a id="6339" class="Symbol">{_}</a> <a id="6343" class="Symbol">{</a><a id="6344" href="CG.Syntax.html#6313" class="Bound">θ</a><a id="6345" class="Symbol">}</a> <a id="6347" class="Symbol">=</a> <a id="6349" href="Agda.Builtin.Equality.html#_%E2%89%A1_.refl" class="InductiveConstructor">refl</a>

<a id="6355" class="Symbol">{-#</a> <a id="6359" class="Keyword">REWRITE</a> <a id="6367" href="CG.Syntax.html#slice-refl-%E2%8A%86-%E2%89%A1" class="Function">slice-refl-⊆-≡</a> <a id="6382" class="Symbol">#-}</a>

<a id="slice-drop-⊆-≡" href="CG.Syntax.html#slice-drop-%E2%8A%86-%E2%89%A1" class="Function">slice-drop-⊆-≡</a> <a id="6402" class="Symbol">:</a> <a id="6404" class="Symbol">∀</a> <a id="6406" class="Symbol">{</a><a id="6407" href="CG.Syntax.html#6407" class="Bound">Γ₁</a> <a id="6410" href="CG.Syntax.html#6410" class="Bound">Γ₂</a><a id="6412" class="Symbol">}</a> <a id="6414" class="Symbol">(</a><a id="6415" href="CG.Syntax.html#6415" class="Bound">θ₁</a> <a id="6418" class="Symbol">:</a> <a id="6420" href="CG.Syntax.html#Env" class="Datatype">Env</a> <a id="6424" href="CG.Syntax.html#6407" class="Bound">Γ₁</a><a id="6426" class="Symbol">)</a> <a id="6428" class="Symbol">(</a><a id="6429" href="CG.Syntax.html#6429" class="Bound">θ₂</a> <a id="6432" class="Symbol">:</a> <a id="6434" href="CG.Syntax.html#Env" class="Datatype">Env</a> <a id="6438" href="CG.Syntax.html#6410" class="Bound">Γ₂</a><a id="6440" class="Symbol">)</a> <a id="6442" class="Symbol">→</a> <a id="6444" href="CG.Syntax.html#slice" class="Function">slice</a> <a id="6450" class="Symbol">(</a><a id="6451" href="CG.Syntax.html#6429" class="Bound">θ₂</a> <a id="6454" href="CG.Syntax.html#_%2B%2B%E1%B4%B1_" class="Function Operator">++ᴱ</a> <a id="6458" href="CG.Syntax.html#6415" class="Bound">θ₁</a><a id="6460" class="Symbol">)</a> <a id="6462" class="Symbol">(</a><a id="6463" href="Generic.Context.Base.html#drop-%E2%8A%86%E2%82%82" class="Function">drop-⊆₂</a> <a id="6471" href="CG.Syntax.html#6407" class="Bound">Γ₁</a> <a id="6474" href="CG.Syntax.html#6410" class="Bound">Γ₂</a><a id="6476" class="Symbol">)</a> <a id="6478" href="Agda.Builtin.Equality.html#_%E2%89%A1_" class="Datatype Operator">≡</a> <a id="6480" href="CG.Syntax.html#6415" class="Bound">θ₁</a>
<a id="6483" href="CG.Syntax.html#slice-drop-%E2%8A%86-%E2%89%A1" class="Function">slice-drop-⊆-≡</a> <a id="6498" href="CG.Syntax.html#6498" class="Bound">θ₁</a> <a id="6501" href="CG.Syntax.html#Env.%5B%5D" class="InductiveConstructor">[]</a> <a id="6504" class="Symbol">=</a> <a id="6506" href="Agda.Builtin.Equality.html#_%E2%89%A1_.refl" class="InductiveConstructor">refl</a>
<a id="6511" href="CG.Syntax.html#slice-drop-%E2%8A%86-%E2%89%A1" class="Function">slice-drop-⊆-≡</a> <a id="6526" href="CG.Syntax.html#6526" class="Bound">θ₁</a> <a id="6529" class="Symbol">(</a><a id="6530" href="CG.Syntax.html#6530" class="Bound">v</a> <a id="6532" href="CG.Syntax.html#Env._%E2%88%B7_" class="InductiveConstructor Operator">∷</a> <a id="6534" href="CG.Syntax.html#6534" class="Bound">θ₂</a><a id="6536" class="Symbol">)</a> <a id="6538" class="Symbol">=</a> <a id="6540" href="CG.Syntax.html#slice-drop-%E2%8A%86-%E2%89%A1" class="Function">slice-drop-⊆-≡</a> <a id="6555" href="CG.Syntax.html#6526" class="Bound">θ₁</a> <a id="6558" href="CG.Syntax.html#6534" class="Bound">θ₂</a>

<a id="6562" class="Symbol">{-#</a> <a id="6566" class="Keyword">REWRITE</a> <a id="6574" href="CG.Syntax.html#slice-drop-%E2%8A%86-%E2%89%A1" class="Function">slice-drop-⊆-≡</a> <a id="6589" class="Symbol">#-}</a>
</pre></body></html>